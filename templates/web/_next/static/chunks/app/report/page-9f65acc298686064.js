(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[420],{8907:function(e,t,l){Promise.resolve().then(l.bind(l,1397))},1397:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return m}});var a,n=l(7437),d=l(7138),r=l(2265),s=l(8775),o=l(8595),i=l(4110),c=l(7104);let u=null!==(a=l(357).env.NEXT_PUBLIC_API_BASE_URL)&&void 0!==a?a:"";async function x(){let e=await fetch("".concat(u,"/api/daily_usage"),{cache:"no-store"});if(!e.ok)throw Error("Request failed with status ".concat(e.status));return e.json()}function m(){var e,t,l,a,u,m,p,b,g;let[j,f]=(0,r.useState)(null),[N,y]=(0,r.useState)(!0),[w,_]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=!0;return(async()=>{try{y(!0);let t=await x();if(!e)return;f(t),_(null)}catch(l){var t;if(!e)return;_(null!==(t=l.message)&&void 0!==t?t:"Unable to load usage report.")}finally{if(!e)return;y(!1)}})(),()=>{e=!1}},[]);let B=(0,r.useMemo)(()=>(null==j?void 0:j.daily_data)?j.daily_data:[],[j]),k=(0,r.useMemo)(()=>{if(0===B.length)return null;let e=B.reduce((e,t)=>{var l,a,n,d,r,s;return{download:e.download+(null!==(d=null===(l=t.download)||void 0===l?void 0:l.raw_bytes)&&void 0!==d?d:0),upload:e.upload+(null!==(r=null===(a=t.upload)||void 0===a?void 0:a.raw_bytes)&&void 0!==r?r:0),combined:e.combined+(null!==(s=null===(n=t.combined)||void 0===n?void 0:n.raw_bytes)&&void 0!==s?s:0)}},{download:0,upload:0,combined:0}),t=B.length;return{...e,days:t,average:t>0?e.combined/t:0}},[B]),E=null!==(u=null===(e=B[0])||void 0===e?void 0:e.date)&&void 0!==u?u:null,S=B.length>0?B[B.length-1].date:null,T=E&&S&&S!==E?"".concat(v(S)," – ").concat(v(E)):E?v(E):"—",D=null!==(m=null==j?void 0:null===(t=j.total_usage)||void 0===t?void 0:t.combined)&&void 0!==m?m:k?(0,c.td)(k.combined):"0 B",U=null!==(p=null==j?void 0:null===(l=j.total_usage)||void 0===l?void 0:l.download)&&void 0!==p?p:k?(0,c.td)(k.download):"0 B",M=null!==(b=null==j?void 0:null===(a=j.total_usage)||void 0===a?void 0:a.upload)&&void 0!==b?b:k?(0,c.td)(k.upload):"0 B",L=k&&k.average>0?"".concat((0,c.td)(k.average)," / hari"):null,R=null!==(g=null==k?void 0:k.days)&&void 0!==g?g:B.length,C=(0,r.useMemo)(()=>{var e;return null!==(e=null==j?void 0:j.last_7_days)&&void 0!==e?e:[]},[j]),I=(0,r.useMemo)(()=>0===C.length?0:C.reduce((e,t)=>{var l,a;return Math.max(e,null!==(a=null===(l=t.combined)||void 0===l?void 0:l.raw_bytes)&&void 0!==a?a:0)},0),[C]),P=C.length>0;return(0,n.jsxs)(s.V,{children:[(0,n.jsx)(o.m,{title:"Data Usage Report",description:"Historical upload, download, and combined usage aggregated from modem telemetry.",actions:(0,n.jsx)(d.default,{href:"/",className:"inline-flex items-center gap-2 rounded-lg border border-neutral-700 px-4 py-2 text-sm font-semibold text-neutral-200 transition hover:border-neutral-500 hover:text-white",children:"Back to dashboard"})}),w&&(0,n.jsx)("div",{className:"rounded-lg border border-red-500/60 bg-red-500/10 px-4 py-3 text-sm text-red-200",children:w}),(0,n.jsxs)("section",{className:"grid gap-4 text-sm text-neutral-200 md:grid-cols-2 xl:grid-cols-4",children:[(0,n.jsx)(h,{label:"Reporting window",value:T,hint:R>0?"".concat(R," day").concat(1===R?"":"s"," tracked"):void 0}),(0,n.jsx)(h,{label:"Total combined",value:D,hint:null!=L?L:void 0,tone:"purple"}),(0,n.jsx)(h,{label:"Total download",value:U,tone:"blue"}),(0,n.jsx)(h,{label:"Total upload",value:M,tone:"green"})]}),(0,n.jsxs)("section",{className:"grid gap-6 ".concat(P?"lg:grid-cols-[minmax(260px,320px),1fr]":""),children:[P?(0,n.jsxs)("aside",{className:"rounded-xl border border-neutral-800 bg-neutral-900/60 p-6 text-sm text-neutral-200",children:[(0,n.jsxs)("header",{className:"mb-4",children:[(0,n.jsx)("h2",{className:"text-base font-semibold text-white",children:"Last 7 days"}),(0,n.jsx)("p",{className:"mt-1 text-xs text-neutral-500",children:"Top-level view of recent usage spikes."})]}),(0,n.jsx)("ul",{className:"space-y-4 text-xs text-neutral-400",children:C.map(e=>{var t,l,a,d,r,s,o,c;let u=null!==(r=null===(t=e.combined)||void 0===t?void 0:t.formatted)&&void 0!==r?r:"0 B",x=null!==(s=null===(l=e.download)||void 0===l?void 0:l.formatted)&&void 0!==s?s:"0 B",m=null!==(o=null===(a=e.upload)||void 0===a?void 0:a.formatted)&&void 0!==o?o:"0 B",h=I>0?Math.min(100,(null!==(c=null===(d=e.combined)||void 0===d?void 0:d.raw_bytes)&&void 0!==c?c:0)/I*100):0;return(0,n.jsxs)("li",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between text-[11px] uppercase tracking-wide text-neutral-500",children:[(0,n.jsx)("span",{children:v(e.date)}),(0,n.jsx)("span",{className:"text-neutral-300",children:u})]}),(0,n.jsx)(i.E,{value:h,className:"bg-neutral-800"}),(0,n.jsxs)("div",{className:"flex items-center justify-between text-[11px] text-neutral-500",children:[(0,n.jsxs)("span",{children:["Down: ",x]}),(0,n.jsxs)("span",{children:["Up: ",m]})]})]},e.date)})})]}):null,(0,n.jsx)("div",{className:"overflow-hidden rounded-xl border border-neutral-800 bg-neutral-900/60",children:(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"min-w-full divide-y divide-neutral-800 text-sm text-neutral-200",children:[(0,n.jsx)("thead",{className:"bg-neutral-900 text-xs uppercase tracking-wider text-neutral-400",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{scope:"col",className:"px-4 py-3 text-left",children:"Date"}),(0,n.jsx)("th",{scope:"col",className:"px-4 py-3 text-right",children:"Download"}),(0,n.jsx)("th",{scope:"col",className:"px-4 py-3 text-right",children:"Upload"}),(0,n.jsx)("th",{scope:"col",className:"px-4 py-3 text-right",children:"Total"}),(0,n.jsx)("th",{scope:"col",className:"px-4 py-3 text-right",children:"Share"})]})}),(0,n.jsx)("tbody",{className:"divide-y divide-neutral-800",children:N?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:5,className:"px-4 py-6 text-center text-xs text-neutral-500",children:"Loading usage history…"})}):0===B.length?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:5,className:"px-4 py-6 text-center text-xs text-neutral-500",children:"Usage history is not available yet."})}):B.map(e=>{var t,l,a,d,r,s,o,i;return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"px-4 py-3 text-left",children:v(e.date)}),(0,n.jsx)("td",{className:"px-4 py-3 text-right text-blue-300",children:null!==(r=null===(t=e.download)||void 0===t?void 0:t.formatted)&&void 0!==r?r:"0 B"}),(0,n.jsx)("td",{className:"px-4 py-3 text-right text-green-300",children:null!==(s=null===(l=e.upload)||void 0===l?void 0:l.formatted)&&void 0!==s?s:"0 B"}),(0,n.jsx)("td",{className:"px-4 py-3 text-right font-semibold",children:null!==(o=null===(a=e.combined)||void 0===a?void 0:a.formatted)&&void 0!==o?o:"0 B"}),(0,n.jsx)("td",{className:"px-4 py-3 text-right text-neutral-400",children:"number"!=typeof(i=null===(d=e.combined)||void 0===d?void 0:d.percentage)||Number.isNaN(i)?"0%":"".concat(i.toFixed(1),"%")})]},e.date)})})]})})})]})]})}function v(e){if(!e)return"—";let t=new Date("".concat(e,"T00:00:00Z"));return Number.isNaN(t.getTime())?e:t.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})}function h(e){let{label:t,value:l,hint:a,tone:d="neutral"}=e;return(0,n.jsxs)("article",{className:"rounded-xl border border-neutral-800 bg-neutral-900/60 p-5",children:[(0,n.jsx)("p",{className:"text-xs uppercase tracking-wide text-neutral-500",children:t}),(0,n.jsx)("p",{className:"mt-2 text-lg font-semibold ".concat("blue"===d?"text-blue-300":"green"===d?"text-green-300":"purple"===d?"text-purple-300":"text-neutral-200"),children:l}),a?(0,n.jsx)("p",{className:"mt-1 text-xs text-neutral-500",children:a}):null]})}}},function(e){e.O(0,[528,762,971,23,744],function(){return e(e.s=8907)}),_N_E=e.O()}]);