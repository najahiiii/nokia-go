(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{93145:function(e,a,t){Promise.resolve().then(t.bind(t,27957))},27957:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return eo}});var l,s=t(57437),n=t(3274),r=t(66706),i=t(4086),d=t(24258),o=t(2265),c=t(27776),u=t(62447),m=t(30338),x=t(62483),g=t(88002),p=t(87138),h=t(87104),f=t(94693),v=t(50495),b=t(36013),j=t(37440);let N=o.forwardRef((e,a)=>{let{className:t,type:l="text",...n}=e;return(0,s.jsx)("input",{type:l,className:(0,j.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...n})});N.displayName="Input";var y=t(70571),w=t(9646);let S=o.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)(w.fC,{className:(0,j.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...l,ref:a,children:(0,s.jsx)(w.bU,{className:(0,j.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})});S.displayName=w.fC.displayName;var _=t(19666);function C(e){let{title:a,description:t,action:l,children:n}=e;return(0,s.jsxs)(b.Zb,{className:"border-border/70 bg-card/80 text-card-foreground",children:[(0,s.jsxs)(b.Ol,{className:"flex flex-row items-start justify-between gap-4 pb-4",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(b.ll,{className:"text-base font-semibold leading-none text-foreground",children:a}),t?(0,s.jsx)(b.SZ,{className:"text-xs text-muted-foreground",children:t}):null]}),l?(0,s.jsx)("div",{className:"flex items-center gap-2",children:l}):null]}),(0,s.jsx)(b.aY,{className:"space-y-4 text-sm text-muted-foreground",children:n})]})}function k(e){let{data:a,ledEnabled:t,ledBusy:l,onToggleLed:n,onRenewIp:r,renewing:i,onReboot:d,rebooting:o,onOpenWanDetails:c,onExtendData:u,onCustomExpirySubmit:m,onCustomExpiryChange:x,customExpiry:g,expiryBusy:p}=e;return(0,s.jsxs)("div",{className:"grid gap-6 xl:grid-cols-[1.2fr,1fr]",children:[(0,s.jsxs)("section",{className:"grid gap-6",children:[(0,s.jsx)(M,{statusWeb:a.statusWeb,serviceData:a.serviceData,cellIdentification:a.cellIdentification,wanStatus:a.wanStatus,preloginStatus:a.preloginStatus,onOpenWanDetails:c}),(0,s.jsx)(E,{dailyUsage:a.dailyUsage}),(0,s.jsx)(P,{dataExpired:a.dataExpired,onExtendThirtyDays:()=>u(2592e3),onSubmit:m,onDateChange:x,dateValue:g,busy:p})]}),(0,s.jsxs)("section",{className:"grid gap-6",children:[(0,s.jsx)(U,{ledEnabled:t,ledBusy:l,onToggleLed:n,onRenewIp:r,renewing:i,onReboot:d,rebooting:o,onOpenWanDetails:c}),(0,s.jsx)(D,{deviceStatus:a.deviceStatus}),(0,s.jsx)(R,{wlan24:a.wlan24,wlan5:a.wlan5}),(0,s.jsx)(A,{preloginStatus:a.preloginStatus})]})]})}function M(e){var a,t,l,n,r,i,d,c,m,x,g,p,f,b,j,N,w,S,_,k,M,D,T,B,E,U,R,A,P,L;let{statusWeb:O,serviceData:F,cellIdentification:V,wanStatus:W,preloginStatus:Z,onOpenWanDetails:H}=e,G=null!==(f=null==O?void 0:null===(t=O.cell_LTE_stats_cfg)||void 0===t?void 0:null===(a=t[0])||void 0===a?void 0:a.stat)&&void 0!==f?f:{},X=[{label:"Band",value:G.Band},{label:"PCI",value:G.PhysicalCellID},{label:"EARFCN",value:G.DownlinkEarfcn},{label:"ECI",value:G.ECI}],q=[{label:"RSRP",value:(0,h.$2)(G.RSRPCurrent,"dBm"),percent:(0,h.gb)(G.RSRPCurrent,-140,-64)},{label:"RSRQ",value:(0,h.$2)(G.RSRQCurrent,"dB"),percent:(0,h.gb)(G.RSRQCurrent,-20,-3)},{label:"SNR",value:(0,h.$2)(G.SNRCurrent,"dB"),percent:(0,h.gb)(G.SNRCurrent,-10,30)},{label:"RSSI",value:(0,h.$2)(G.RSSICurrent,"dBm"),percent:(0,h.gb)(G.RSSICurrent,-120,-30)}],{downlink:Y,uplink:J}=(0,o.useMemo)(()=>{var e;let a=e=>Array.isArray(e)?e:e&&"object"==typeof e?Object.values(e):[],t=null!==(e=null==F?void 0:F.FunctionResult)&&void 0!==e?e:{};return{downlink:a(null==t?void 0:t.LTEDLCA),uplink:a(null==t?void 0:t.LTEULCA)}},[F]),Q=(null!==(b=null==Y?void 0:Y.length)&&void 0!==b?b:0)>0||(null!==(j=null==J?void 0:J.length)&&void 0!==j?j:0)>0,$=null!==(S=null!==(w=null!==(N=null==V?void 0:null===(l=V.FunctionResult)||void 0===l?void 0:l.Name)&&void 0!==N?N:null==V?void 0:V.Name)&&void 0!==w?w:null==V?void 0:null===(n=V.functionResult)||void 0===n?void 0:n.Name)&&void 0!==S?S:null,K=null!==(_=null==Z?void 0:null===(d=Z.wan_conns)||void 0===d?void 0:null===(i=d[0])||void 0===i?void 0:null===(r=i.ipConns)||void 0===r?void 0:r[0])&&void 0!==_?_:{},ee=null!==(k=null==W?void 0:null===(x=W.wan_conns)||void 0===x?void 0:null===(m=x[0])||void 0===m?void 0:null===(c=m.ipConns)||void 0===c?void 0:c[0])&&void 0!==k?k:{},ea=null!==(M=(0,h.SR)(Z))&&void 0!==M?M:"—",et=null!==(T=null!==(D=ee.X_CT_COM_IPv6IPAddress)&&void 0!==D?D:K.X_CT_COM_IPv6IPAddress)&&void 0!==T?T:"—",el=null!==(B=null==K?void 0:K.DNSServers)&&void 0!==B?B:"—",es=null!==(E=null==K?void 0:K.X_CT_COM_IPv6DNSServers)&&void 0!==E?E:"—",en=null!==(R=null!==(U=ee.DefaultGateway)&&void 0!==U?U:K.DefaultGateway)&&void 0!==R?R:"—",er=null!==(P=null!==(A=ee.ConnectionStatus)&&void 0!==A?A:K.ConnectionStatus)&&void 0!==P?P:"Unknown",ei=null!==(L=null==Z?void 0:null===(p=Z.device_cfg)||void 0===p?void 0:null===(g=p[0])||void 0===g?void 0:g.X_ALU_COM_LastActiveTime)&&void 0!==L?L:null,ed=(0,h._o)(ei),eo="string"==typeof ei&&""!==ei.trim()&&"—"!==ed&&ed!==ei?"".concat(ed," • ").concat(ei):ed;return(0,s.jsxs)(C,{title:null!=$?$:"LTE Signal",description:"Signal quality, carrier aggregation, and WAN connection summary",action:(0,s.jsx)(v.z,{variant:"link",size:"sm",onClick:H,className:"px-0",children:"View details"}),children:[(0,s.jsxs)(u.fC,{defaultValue:"signal",className:"space-y-3",children:[(0,s.jsxs)(u.aV,{className:"inline-flex w-full items-center gap-1 rounded-lg border border-neutral-800 bg-neutral-900/60 p-0.5 text-xs font-semibold uppercase tracking-wide",children:[(0,s.jsx)(u.xz,{value:"signal",className:"flex-1 rounded-md px-3 py-1 text-neutral-400 transition hover:text-white data-[state=active]:bg-neutral-800 data-[state=active]:text-white",children:"Signal"}),(0,s.jsx)(u.xz,{value:"ca",className:"flex-1 rounded-md px-3 py-1 text-neutral-400 transition hover:text-white data-[state=active]:bg-neutral-800 data-[state=active]:text-white",children:"Carrier Agg."})]}),(0,s.jsxs)(u.VY,{value:"signal",className:"space-y-3",children:[(0,s.jsx)("div",{className:"grid grid-cols-1 gap-2 text-sm text-neutral-400",children:(0,s.jsx)("span",{className:"font-semibold text-neutral-500",children:"Main Signal"})}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2 text-xs text-neutral-400",children:X.map(e=>{let{label:a,value:t}=e;return(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("span",{className:"font-semibold text-neutral-500",children:a}),(0,s.jsx)("span",{className:"text-sm text-neutral-200",children:null!=t?t:"—"})]},a)})}),(0,s.jsx)("hr",{className:"border-neutral-800"}),(0,s.jsx)("div",{className:"space-y-3 text-xs text-neutral-400",children:q.map(e=>{let{label:a,value:t,percent:l}=e;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"mb-1.5 flex items-center justify-between",children:[(0,s.jsx)("span",{className:"font-semibold text-neutral-500",children:a}),(0,s.jsx)("span",{className:"text-sm text-neutral-200",children:t})]}),(0,s.jsx)(y.E,{value:l,className:"h-1.5 bg-neutral-800"})]},a)})})]}),(0,s.jsx)(u.VY,{value:"ca",className:"space-y-3",children:Q?(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsx)(I,{title:"Downlink",carriers:Y}),(0,s.jsx)(I,{title:"Uplink",carriers:J})]}):(0,s.jsx)("p",{className:"text-xs text-neutral-500",children:"Carrier aggregation data is not available."})})]}),(0,s.jsx)("div",{className:"space-y-3 text-xs text-muted-foreground",children:(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(z,{label:"External IPv4",value:ea}),(0,s.jsx)(z,{label:"External IPv6",value:et}),(0,s.jsx)(z,{label:"Gateway",value:en}),(0,s.jsx)(z,{label:"DNSv4",value:el}),(0,s.jsx)(z,{label:"DNSv6",value:es}),(0,s.jsx)(z,{label:"Status",value:er}),(0,s.jsx)(z,{label:"Session",value:eo})]})})]})}function D(e){var a,t,l,n,r,i,d;let{deviceStatus:o}=e,c=null!==(n=null==o?void 0:o.UpTime)&&void 0!==n?n:0,u=null!==(r=null==o?void 0:null===(a=o.cpu_usageinfo)||void 0===a?void 0:a.CPUUsage)&&void 0!==r?r:null,m=null!==(i=null==o?void 0:null===(t=o.mem_info)||void 0===t?void 0:t.Total)&&void 0!==i?i:0,x=null!==(d=null==o?void 0:null===(l=o.mem_info)||void 0===l?void 0:l.Free)&&void 0!==d?d:0,g=m>0?Math.round((m-x)/m*100):0;return(0,s.jsx)(C,{title:"Device Health",description:"Runtime statistics reported by the modem",children:(0,s.jsxs)("div",{className:"grid gap-3",children:[(0,s.jsx)(z,{label:"Uptime",value:(0,h.d5)(c)}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,s.jsx)("span",{className:"font-semibold text-muted-foreground",children:"CPU Usage"}),(0,s.jsxs)(f.C,{variant:"outline",className:"font-semibold",children:[u,"%"]})]}),(0,s.jsx)(y.E,{value:u,className:"h-2"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,s.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Memory Usage"}),(0,s.jsxs)(f.C,{variant:"outline",className:"font-semibold",children:[g,"%"]})]}),(0,s.jsx)(y.E,{value:g,className:"h-2"})]})]})})}function T(e){if(0===e.length)return{rows:[],totals:{download:"0 B",upload:"0 B",combined:"0 B"}};let a=e.reduce((e,a)=>e+a.downloadBytes,0),t=e.reduce((e,a)=>e+a.uploadBytes,0),l=e.reduce((e,a)=>e+a.combinedBytes,0);return{rows:e.map((a,t)=>{let s=e[t+1],n=B(a.combinedBytes,null==s?void 0:s.combinedBytes,null==s?void 0:s.label),r=B(a.downloadBytes,null==s?void 0:s.downloadBytes,null==s?void 0:s.label),i=B(a.uploadBytes,null==s?void 0:s.uploadBytes,null==s?void 0:s.label);return{key:a.key,label:a.label,download:(0,h.td)(a.downloadBytes),upload:(0,h.td)(a.uploadBytes),combined:(0,h.td)(a.combinedBytes),share:(0,h.rl)(l>0?a.combinedBytes/l*100:0),downloadBytes:a.downloadBytes,uploadBytes:a.uploadBytes,combinedBytes:a.combinedBytes,previousCombinedBytes:null==s?void 0:s.combinedBytes,downloadTrend:r,uploadTrend:i,trend:n}}),totals:{download:(0,h.td)(a),upload:(0,h.td)(t),combined:(0,h.td)(l)}}}function B(e,a,t){let l,n,r;if(null==a)return null;let i=e-a,d=0===i?"flat":i>0?"up":"down",o=Math.abs(i),c=a>0?o/a*100:null,u="down"===d?"-":"up"===d?"+":"",p="flat"===d?"0":"".concat(u).concat((0,h.td)(o)),f=null===c||"flat"===d?void 0:"".concat(u).concat(c.toFixed(1),"%");"up"===d?(l=(0,s.jsx)(m.Z,{className:"h-3.5 w-3.5 text-emerald-400"}),n="text-emerald-400",r="Naik"):"down"===d?(l=(0,s.jsx)(x.Z,{className:"h-3.5 w-3.5 text-rose-400"}),n="text-rose-400",r="Turun"):(l=(0,s.jsx)(g.Z,{className:"h-3.5 w-3.5 text-muted-foreground"}),n="text-muted-foreground",r="Tidak berubah");let v=null!=t?t:"periode sebelumnya",b="flat"===d?"".concat(r," dibanding ").concat(v):"".concat(r," ").concat((0,h.td)(o)).concat(f?" (".concat(f,")"):""," dibanding ").concat(v);return{icon:l,deltaLabel:p,percentLabel:f,className:n,tooltip:b,previousLabel:v}}function E(e){let{dailyUsage:a}=e,t=(0,o.useMemo)(()=>Array.isArray(null==a?void 0:a.daily_data)?a.daily_data:Array.isArray(null==a?void 0:a.last_7_days)?a.last_7_days:[],[a]),l=(0,o.useMemo)(()=>t.map(e=>{var a,t,l,s,n,r;let i=null==e?void 0:e.date;if(!i)return null;let d=new Date("".concat(i,"T00:00:00Z"));return Number.isNaN(d.getTime())?null:{key:i,date:d,downloadBytes:null!==(s=null==e?void 0:null===(a=e.download)||void 0===a?void 0:a.raw_bytes)&&void 0!==s?s:0,uploadBytes:null!==(n=null==e?void 0:null===(t=e.upload)||void 0===t?void 0:t.raw_bytes)&&void 0!==n?n:0,combinedBytes:null!==(r=null==e?void 0:null===(l=e.combined)||void 0===l?void 0:l.raw_bytes)&&void 0!==r?r:0}}).filter(e=>null!==e).sort((e,a)=>a.date.getTime()-e.date.getTime()),[t]),n=(0,o.useMemo)(()=>l.slice(0,7).map(e=>({key:e.key,label:(0,h.p6)(e.key),sortValue:e.date.getTime(),downloadBytes:e.downloadBytes,uploadBytes:e.uploadBytes,combinedBytes:e.combinedBytes})),[l]),r=(0,o.useMemo)(()=>{let e=new Map;return l.forEach(a=>{let t=function(e){let a=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())),t=a.getUTCDay();return a.setUTCDate(a.getUTCDate()-(t+6)%7),a}(a.date),l=new Date(t);l.setUTCDate(l.getUTCDate()+6);let s=t.toISOString().slice(0,10);e.has(s)||e.set(s,{key:s,label:"".concat((0,h.p6)(s)," – ").concat((0,h.p6)(l.toISOString().slice(0,10))),sortValue:t.getTime(),downloadBytes:0,uploadBytes:0,combinedBytes:0});let n=e.get(s);n.downloadBytes+=a.downloadBytes,n.uploadBytes+=a.uploadBytes,n.combinedBytes+=a.combinedBytes}),Array.from(e.values()).sort((e,a)=>a.sortValue-e.sortValue).slice(0,8)},[l]),i=(0,o.useMemo)(()=>{let e=new Map;return l.forEach(a=>{var t;let l=new Date(Date.UTC((t=a.date).getUTCFullYear(),t.getUTCMonth(),1)),s="".concat(l.getUTCFullYear(),"-").concat(String(l.getUTCMonth()+1).padStart(2,"0"));e.has(s)||e.set(s,{key:s,label:l.toLocaleDateString("id-ID",{month:"long",year:"numeric"}),sortValue:l.getTime(),downloadBytes:0,uploadBytes:0,combinedBytes:0});let n=e.get(s);n.downloadBytes+=a.downloadBytes,n.uploadBytes+=a.uploadBytes,n.combinedBytes+=a.combinedBytes}),Array.from(e.values()).sort((e,a)=>a.sortValue-e.sortValue).slice(0,12)},[l]),d=(0,o.useMemo)(()=>T(n),[n]),c=(0,o.useMemo)(()=>T(r),[r]),m=(0,o.useMemo)(()=>T(i),[i]),x=(0,o.useMemo)(()=>{if(l.length<2)return null;let[e,a]=l;return B(e.combinedBytes,a.combinedBytes,(0,h.p6)(a.key))},[l]),g=(0,o.useMemo)(()=>{if(r.length<2)return null;let[e,a]=r;return B(e.combinedBytes,a.combinedBytes,a.label)},[r]),p=(0,o.useMemo)(()=>{if(i.length<2)return null;let[e,a]=i;return B(e.combinedBytes,a.combinedBytes,a.label)},[i]),f=(0,o.useMemo)(()=>[{key:"daily",label:"Harian",dataset:d,emptyMessage:"Belum ada data harian yang terekam."},{key:"weekly",label:"Mingguan",dataset:c,emptyMessage:"Belum ada agregasi mingguan yang tersedia."},{key:"monthly",label:"Bulanan",dataset:m,emptyMessage:"Belum ada agregasi bulanan yang tersedia."}],[d,c,m]);return(0,s.jsx)(C,{title:"Data Usage",description:"Breakdown of modem traffic across daily, weekly, and monthly windows",action:(0,s.jsx)(O,{href:"/report",children:"Full report"}),children:(0,s.jsxs)(u.fC,{defaultValue:"daily",className:"space-y-4",children:[(0,s.jsx)(u.aV,{className:"inline-flex w-full items-center gap-1 rounded-lg border border-border/70 bg-muted/20 p-0.5 text-xs font-semibold uppercase tracking-wide",children:f.map(e=>(0,s.jsx)(u.xz,{value:e.key,className:"flex-1 rounded-md px-3 py-1 text-muted-foreground transition hover:text-foreground data-[state=active]:bg-muted data-[state=active]:text-foreground",children:e.label},e.key))}),f.map(e=>{let a="daily"===e.key?x:"weekly"===e.key?g:p;return(0,s.jsxs)(u.VY,{value:e.key,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-xs text-muted-foreground",children:[(0,s.jsx)(L,{label:"Download",value:e.dataset.totals.download,tone:"blue",customClass:"text-center"}),(0,s.jsx)(L,{label:"Upload",value:e.dataset.totals.upload,tone:"green",customClass:"text-center"}),(0,s.jsx)(L,{label:"Total",value:e.dataset.totals.combined,tone:"neutral",customClass:"text-center"})]}),a?(0,s.jsxs)("div",{className:"flex gap-1 rounded-lg border border-border/60 bg-muted/30 px-3 py-2 text-xs flex-row items-center justify-between",children:[(0,s.jsxs)(_.u,{children:[(0,s.jsx)(_.aJ,{asChild:!0,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[a.icon,(0,s.jsxs)("span",{className:"font-semibold ".concat(a.className),children:[a.deltaLabel,a.percentLabel?" (".concat(a.percentLabel,")"):""]})]})}),(0,s.jsx)(_._v,{children:a.tooltip})]}),(0,s.jsxs)("span",{className:"text-muted-foreground",children:["Dibanding ",a.previousLabel]})]}):null,(0,s.jsx)("div",{className:"overflow-hidden rounded-lg border border-border/50",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-border/60 text-xs sm:text-sm",children:[(0,s.jsx)("thead",{className:"bg-muted/50 text-muted-foreground",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left font-semibold",children:"Periode"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right font-semibold",children:"Download"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right font-semibold",children:"Upload"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right font-semibold",children:"Total"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-border/60 text-foreground",children:0===e.dataset.rows.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:5,className:"px-4 py-4 text-center text-xs text-muted-foreground",children:e.emptyMessage})}):e.dataset.rows.map(a=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-4 py-2",children:a.label}),(0,s.jsx)("td",{className:"px-4 py-2 text-right",children:a.downloadTrend?(0,s.jsxs)(_.u,{children:[(0,s.jsx)(_.aJ,{asChild:!0,children:(0,s.jsxs)("span",{className:"inline-flex items-center justify-end gap-1",children:[(0,s.jsx)("span",{className:a.downloadTrend.className,children:a.downloadTrend.icon}),(0,s.jsx)("span",{className:"text-blue-400",children:a.download})]})}),(0,s.jsx)(_._v,{children:a.downloadTrend.tooltip})]}):(0,s.jsx)("span",{className:"text-blue-400",children:a.download})}),(0,s.jsx)("td",{className:"px-4 py-2 text-right",children:a.uploadTrend?(0,s.jsxs)(_.u,{children:[(0,s.jsx)(_.aJ,{asChild:!0,children:(0,s.jsxs)("span",{className:"inline-flex items-center justify-end gap-1",children:[(0,s.jsx)("span",{className:a.uploadTrend.className,children:a.uploadTrend.icon}),(0,s.jsx)("span",{className:"text-emerald-400",children:a.upload})]})}),(0,s.jsx)(_._v,{children:a.uploadTrend.tooltip})]}):(0,s.jsx)("span",{className:"text-emerald-400",children:a.upload})}),(0,s.jsx)("td",{className:"px-4 py-2 text-right",children:a.trend?(0,s.jsxs)(_.u,{children:[(0,s.jsx)(_.aJ,{asChild:!0,children:(0,s.jsxs)("span",{className:"inline-flex items-center justify-end gap-1",children:[(0,s.jsx)("span",{className:a.trend.className,children:a.trend.icon}),a.combined]})}),(0,s.jsx)(_._v,{children:a.trend.tooltip})]}):(0,s.jsx)("span",{className:"inline-flex justify-end",children:a.combined})})]},"".concat(e.key,"-").concat(a.key)))})]})})]},e.key)})]})})}function I(e){let{title:a,carriers:t}=e;return t&&0!==t.length?(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:a}),(0,s.jsx)("ul",{className:"mt-3 space-y-3 text-xs text-muted-foreground",children:t.map((e,t)=>{var l,n,r,i;return(0,s.jsx)("li",{className:"rounded-lg border border-border/60 bg-muted/40 p-3",children:(0,s.jsxs)("div",{className:"grid grid-cols-[1fr,auto] gap-2",children:[(0,s.jsx)("span",{children:"Band"}),(0,s.jsx)("span",{className:"text-foreground",children:null!==(l=e.ScellBand)&&void 0!==l?l:"—"}),(0,s.jsx)("span",{children:"Bandwidth"}),(0,s.jsx)("span",{className:"text-foreground",children:null!==(n=e.ScellBandwidth)&&void 0!==n?n:"—"}),(0,s.jsx)("span",{children:"PCI"}),(0,s.jsx)("span",{className:"text-foreground",children:null!==(r=e.PhysicalCellID)&&void 0!==r?r:"—"}),(0,s.jsx)("span",{children:"EARFCN"}),(0,s.jsx)("span",{className:"text-foreground",children:null!==(i=e.ScellChannel)&&void 0!==i?i:"—"})]})},"".concat(a,"-").concat(t))})})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:a}),(0,s.jsx)("p",{className:"mt-2 text-xs text-muted-foreground",children:"No carriers detected."})]})}function U(e){let{ledEnabled:a,ledBusy:t,onToggleLed:l,onRenewIp:n,renewing:r,onReboot:i,rebooting:d,onOpenWanDetails:o}=e;return(0,s.jsx)(C,{title:"Controls & Actions",description:"Operate modem features and shortcuts",children:(0,s.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-border/60 bg-muted/40 p-4",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-foreground",children:"Device LEDs"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Toggle the enclosure indicators for a quieter environment."})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(f.C,{variant:"outline",className:"text-xs",children:null===a?"Unknown":a?"Enabled":"Disabled"}),(0,s.jsx)(S,{checked:!!a,onCheckedChange:e=>l(e),disabled:t,"aria-label":"Toggle device LEDs"})]})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(v.z,{onClick:n,disabled:r,className:"w-full justify-start",children:r?"Renewing…":"Renew WAN IP"}),(0,s.jsx)(v.z,{onClick:i,disabled:d,variant:"destructive",className:"w-full justify-start",children:d?"Rebooting…":"Reboot modem"}),(0,s.jsx)(v.z,{variant:"outline",onClick:o,className:"w-full justify-start",children:"WAN details"})]})]})})}function R(e){var a,t,l,n,r,i;let{wlan24:d,wlan5:o}=e,c=[{label:"2.4 GHz",config:null!==(n=null==d?void 0:null===(a=d.wlan_config_glb)||void 0===a?void 0:a[0])&&void 0!==n?n:null},{label:"5 GHz",config:null!==(i=null!==(r=null==o?void 0:null===(t=o.wlan_config_glb11ac)||void 0===t?void 0:t[0])&&void 0!==r?r:null==o?void 0:null===(l=o.wlan_config_glb)||void 0===l?void 0:l[0])&&void 0!==i?i:null}];return(0,s.jsx)(C,{title:"Wi-Fi Radios",description:"SSID, channel, and security overview",children:(0,s.jsx)("div",{className:"space-y-3 text-sm text-muted-foreground",children:c.map(e=>{var a,t,l,n;let{label:r,config:i}=e,d=(0,h.sw)(null==i?void 0:i.Enable);return(0,s.jsxs)("div",{className:"rounded-lg border border-border/60 bg-muted/40 px-4 py-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold text-foreground",children:null!==(a=null==i?void 0:i.SSID)&&void 0!==a?a:"—"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:r})]}),(0,s.jsx)(f.C,{variant:d?"secondary":"outline",className:d?"bg-emerald-500/15 text-emerald-400":"text-muted-foreground",children:d?"Enabled":"Disabled"})]}),(0,s.jsxs)("dl",{className:"mt-3 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("dt",{children:"Mode"}),(0,s.jsx)("dd",{className:"text-foreground",children:null!==(t=null==i?void 0:i.X_ALU_COM_Mode)&&void 0!==t?t:"—"})]}),(0,s.jsxs)("div",{className:"ml-auto text-right",children:[(0,s.jsx)("dt",{children:"Channel"}),(0,s.jsx)("dd",{className:"text-foreground",children:null!==(l=null==i?void 0:i.Channel)&&void 0!==l?l:"Auto"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("dt",{children:"Bandwidth"}),(0,s.jsx)("dd",{className:"text-foreground",children:null!==(n=null==i?void 0:i.X_ALU_COM_Bandwidth)&&void 0!==n?n:"—"})]}),(0,s.jsxs)("div",{className:"ml-auto text-right",children:[(0,s.jsx)("dt",{children:"Security"}),(0,s.jsx)("dd",{className:"text-foreground",children:(0,h.FM)(i)})]})]})]},r)})})})}function A(e){let{preloginStatus:a}=e,t=(Array.isArray(null==a?void 0:a.device_cfg)?a.device_cfg:[]).filter(e=>1===e.Active),l=t.filter(e=>"Ethernet"===e.InterfaceType).length,n=t.filter(e=>"Ethernet"!==e.InterfaceType).length,r=t.slice(0,6).map(e=>{var a,t,l;return{id:null!==(l=null!==(t=null!==(a=e.MACAddress)&&void 0!==a?a:e.ID)&&void 0!==t?t:e.HostName)&&void 0!==l?l:Math.random().toString(36),name:e.HostName||e.Alias||"Unknown device",ip:e.IPAddress||"—",iface:e.InterfaceType||"Unknown"}});return(0,s.jsxs)(C,{title:"Connected Devices",description:"Active clients reported by the modem",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-center text-sm text-muted-foreground",children:[(0,s.jsxs)("div",{className:"rounded-lg border border-border/60 bg-muted/40 p-4",children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide",children:"Ethernet"}),(0,s.jsx)("p",{className:"mt-2 text-2xl font-semibold text-foreground",children:l})]}),(0,s.jsxs)("div",{className:"rounded-lg border border-border/60 bg-muted/40 p-4",children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide",children:"Wi-Fi"}),(0,s.jsx)("p",{className:"mt-2 text-2xl font-semibold text-foreground",children:n})]})]}),(0,s.jsx)("div",{className:"mt-4 space-y-2 text-xs",children:0===r.length?(0,s.jsx)("p",{className:"text-muted-foreground",children:"No active clients detected."}):r.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-border/60 bg-muted/40 px-3 py-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold text-foreground",children:e.name}),(0,s.jsx)("p",{className:"text-[11px] text-muted-foreground",children:e.ip})]}),(0,s.jsx)(f.C,{variant:"outline",className:"text-[11px] uppercase",children:e.iface})]},e.id))})]})}function P(e){let{dataExpired:a,onExtendThirtyDays:t,onSubmit:l,onDateChange:n,dateValue:r,busy:i}=e,d=(0,o.useMemo)(()=>{if(!a)return{label:"Not configured",tone:"neutral"};let e=new Date(1e3*a),t=new Date,l=Math.floor((e.getTime()-t.getTime())/864e5);return l<0?{label:"".concat((0,h.p6)(e.toISOString().slice(0,10))," (expired ").concat(Math.abs(l)," day").concat(-1===l?"":"s"," ago)"),tone:"danger"}:l<=3?{label:"".concat((0,h.p6)(e.toISOString().slice(0,10))," (").concat(l," day").concat(1===l?"":"s"," remaining)"),tone:"warning"}:{label:"".concat((0,h.p6)(e.toISOString().slice(0,10))," (").concat(l," day").concat(1===l?"":"s"," remaining)"),tone:"success"}},[a]),c="danger"===d.tone?"text-red-400":"warning"===d.tone?"text-yellow-400":"success"===d.tone?"text-green-400":"text-neutral-300";return(0,s.jsxs)(C,{title:"Data Expiration",description:"Manage how long modem traffic counters remain valid",children:[(0,s.jsx)("p",{className:"text-sm font-semibold ".concat(c),children:d.label}),(0,s.jsxs)("form",{className:"mt-4 space-y-4",onSubmit:l,children:[(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Expiration date"}),(0,s.jsx)(N,{type:"date",value:r,onChange:e=>n(e.target.value),disabled:i})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(v.z,{type:"button",onClick:t,disabled:i,variant:"secondary",className:"w-full",children:"Extend 30 Days"}),(0,s.jsx)(v.z,{type:"submit",disabled:i||!r,className:"w-full",children:"Save Date"})]})]})]})}function z(e){let{label:a,value:t,highlight:l}=e;return(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,s.jsx)("span",{className:"font-semibold",children:a}),(0,s.jsx)("span",{className:l?"text-foreground":"text-muted-foreground",children:t})]})}function L(e){let{label:a,value:t,tone:l,customClass:n}=e;return(0,s.jsxs)("div",{className:"flex h-full flex-col justify-center ".concat(n),children:[(0,s.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-muted-foreground",children:a}),(0,s.jsx)("p",{className:"mt-1 text-base font-semibold ".concat("blue"===l?"text-blue-400":"green"===l?"text-emerald-400":"text-foreground"),children:t})]})}function O(e){let{href:a,children:t}=e;return(0,s.jsx)(v.z,{asChild:!0,variant:"outline",size:"sm",className:"gap-2",children:(0,s.jsx)(p.default,{href:a,children:t})})}var F=t(47019),V=t(75733),W=t(13304);let Z=W.fC;W.xz;let H=W.h_;W.x8;let G=o.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)(W.aV,{ref:a,className:(0,j.cn)("fixed inset-0 z-50 bg-black/60 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=open]:fade-in-0 data-[state=closed]:fade-out-0",t),...l})});G.displayName=W.aV.displayName;let X=o.forwardRef((e,a)=>{let{className:t,children:l,...n}=e;return(0,s.jsxs)(H,{children:[(0,s.jsx)(G,{}),(0,s.jsx)(W.VY,{ref:a,className:(0,j.cn)("fixed left-1/2 top-1/2 z-50 grid w-full max-w-[calc(100vw-3rem)] -translate-x-1/2 -translate-y-1/2 gap-6 rounded-lg border border-border bg-background p-6 shadow-lg duration-200 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-90 data-[state=closed]:zoom-out-95 sm:max-w-3xl sm:p-8",t),...n,children:l})]})});X.displayName=W.VY.displayName;let q=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,j.cn)("flex flex-col space-y-2 text-left",a),...t})};q.displayName="DialogHeader";let Y=o.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)(W.Dx,{ref:a,className:(0,j.cn)("text-lg font-semibold leading-none tracking-tight",t),...l})});Y.displayName=W.Dx.displayName;let J=o.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)(W.dk,{ref:a,className:(0,j.cn)("text-sm text-muted-foreground",t),...l})});J.displayName=W.dk.displayName;let Q=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,j.cn)("space-y-4 text-sm",a),...t})};Q.displayName="DialogBody";let $=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,j.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...t})};$.displayName="DialogFooter";var K=t(2286);let ee=o.forwardRef((e,a)=>{let{className:t,children:l,...n}=e;return(0,s.jsxs)(K.fC,{ref:a,className:(0,j.cn)("relative overflow-hidden",t),...n,children:[(0,s.jsx)(K.l_,{className:"h-full w-full rounded-[inherit]",children:l}),(0,s.jsx)(ea,{}),(0,s.jsx)(K.Ns,{})]})});ee.displayName=K.fC.displayName;let ea=o.forwardRef((e,a)=>{let{className:t,orientation:l="vertical",...n}=e;return(0,s.jsx)(K.gb,{ref:a,orientation:l,className:(0,j.cn)("flex touch-none select-none transition-colors","vertical"===l&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===l&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:(0,s.jsx)(K.q4,{className:"relative flex-1 rounded-full bg-border"})})});function et(e){var a,t;let{open:l,onClose:n,messages:r,busy:i,onRefresh:d,onMarkRead:o,onDelete:c,selectedSmsId:u,onSelect:m}=e,x=null!==(t=null!==(a=r.find(e=>e.SMSID===u))&&void 0!==a?a:r[0])&&void 0!==t?t:null;return(0,s.jsx)(Z,{open:l,onOpenChange:e=>{e||n()},children:(0,s.jsxs)(X,{children:[(0,s.jsxs)(q,{children:[(0,s.jsx)(Y,{children:"SMS Inbox"}),(0,s.jsxs)(J,{children:[r.length," message",1===r.length?"":"s"," stored on the modem."]})]}),(0,s.jsx)(Q,{children:(0,s.jsxs)("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,260px),minmax(0,1fr)] lg:max-h-[70vh]",children:[(0,s.jsx)(ee,{className:"min-h-[220px] max-h-[50vh] rounded-md border border-border bg-muted/20 lg:h-[60vh] lg:max-h-none",children:0===r.length?(0,s.jsx)("p",{className:"px-4 py-6 text-sm text-muted-foreground",children:"Inbox is empty."}):(0,s.jsx)("ul",{className:"text-sm",children:r.map(e=>(0,s.jsxs)("li",{onClick:()=>m(e.SMSID),className:"cursor-pointer border-b border-border/60 px-4 py-3 transition hover:bg-muted ".concat(e.SMSID===(null==x?void 0:x.SMSID)?"bg-muted/60":""),children:[(0,s.jsx)("p",{className:"font-semibold ".concat(e.SMSUnread?"text-foreground":"text-muted-foreground"),children:e.SMSSender||"Unknown sender"}),(0,s.jsx)("p",{className:"mt-1 line-clamp-2 text-xs text-muted-foreground",children:e.SMSContent||"(empty message)"}),(0,s.jsx)("p",{className:"mt-2 text-[10px] uppercase tracking-wide text-muted-foreground/80",children:(0,h.F1)(e.SMSDateTime)})]},e.SMSID))})}),(0,s.jsx)("section",{className:"flex min-h-[220px] max-h-[50vh] flex-col gap-4 rounded-md border border-border bg-muted/10 p-4 lg:h-[60vh] lg:max-h-none",children:x?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:x.SMSSender||"Unknown sender"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,h.F1)(x.SMSDateTime)})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.z,{variant:"outline",size:"sm",onClick:()=>o(x,!x.SMSUnread),disabled:i,children:x.SMSUnread?"Mark as read":"Mark as unread"}),(0,s.jsx)(v.z,{variant:"destructive",size:"sm",onClick:()=>c(x.SMSID),disabled:i,children:"Delete"})]})]}),(0,s.jsx)(ee,{className:"flex-1 rounded-md border border-border bg-background p-4",children:(0,s.jsx)("p",{className:"whitespace-pre-wrap text-sm text-muted-foreground",children:x.SMSContent||"(empty message)"})})]}):(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Select a message on the left to read its contents."})})]})}),(0,s.jsxs)($,{className:"gap-2",children:[(0,s.jsx)(v.z,{variant:"outline",onClick:d,disabled:i,children:"Refresh"}),(0,s.jsx)(v.z,{variant:"ghost",onClick:n,children:"Close"})]})]})})}function el(e){var a,t;let{open:l,onClose:n,draft:r,onChange:i,onSubmit:d,saving:c}=e,[u,m]=(0,o.useState)(!1),[x,g]=(0,o.useState)(!1);if(!l||!r)return null;let p="true"===r.telegram_enabled,h="true"===r.long_polling_enabled,f="true"===r.long_polling_forward_sms_to_telegram;return(0,s.jsx)(Z,{open:l,onOpenChange:e=>{e||n()},children:(0,s.jsxs)(X,{children:[(0,s.jsxs)(q,{children:[(0,s.jsx)(Y,{children:"Edit Configuration"}),(0,s.jsx)(J,{children:"Update modem credentials, listener address, and optional Telegram bridge."})]}),(0,s.jsxs)("form",{className:"space-y-6",onSubmit:d,children:[(0,s.jsxs)(Q,{className:"max-h-[65vh] space-y-6 overflow-y-auto pr-1 text-sm",children:[(0,s.jsxs)("div",{className:"grid gap-4",children:[(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Modem Host"}),(0,s.jsx)(N,{value:r.router_host,onChange:e=>i("router_host",e.target.value),required:!0})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Modem User"}),(0,s.jsx)(N,{value:r.router_user,onChange:e=>i("router_user",e.target.value)})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Modem Password"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(N,{type:u?"text":"password",value:r.router_password,onChange:e=>i("router_password",e.target.value),className:"pr-10"}),(0,s.jsx)(v.z,{type:"button",variant:"ghost",size:"icon",onClick:()=>m(e=>!e),className:"absolute right-1.5 top-1/2 -translate-y-1/2","aria-label":u?"Hide password":"Show password",children:u?(0,s.jsx)(F.Z,{className:"h-4 w-4"}):(0,s.jsx)(V.Z,{className:"h-4 w-4"})})]})]})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Listen Host"}),(0,s.jsx)(N,{value:r.listen_host,onChange:e=>i("listen_host",e.target.value),required:!0})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Listen Port"}),(0,s.jsx)(N,{value:r.listen_port,onChange:e=>i("listen_port",e.target.value),required:!0})]})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Poll interval (ms)"}),(0,s.jsx)(N,{value:null!==(a=r.poll_interval_ms)&&void 0!==a?a:"",onChange:e=>i("poll_interval_ms",e.target.value),inputMode:"numeric",pattern:"[0-9]*"})]})]}),(0,s.jsxs)("section",{className:"space-y-4 rounded-lg border border-border bg-muted/10 p-4",children:[(0,s.jsxs)("header",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:"Server Polling"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Enable backend polling of the modem for SMS forwarding and similar tasks."})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:"Enabled"}),(0,s.jsx)(S,{checked:h,onCheckedChange:e=>i("long_polling_enabled",e?"true":"false"),"aria-label":"Toggle server polling"})]})]}),(0,s.jsx)("div",{className:"grid gap-4 sm:grid-cols-2",children:(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Poll interval (seconds)"}),(0,s.jsx)(N,{value:null!==(t=r.long_polling_interval_seconds)&&void 0!==t?t:"",onChange:e=>i("long_polling_interval_seconds",e.target.value),disabled:!h,inputMode:"numeric",pattern:"[0-9]*",placeholder:"10"}),(0,s.jsx)("span",{className:"text-[11px] text-muted-foreground",children:"Must be at least 5 seconds. Defaults to 10 seconds."})]})})]}),(0,s.jsxs)("section",{className:"space-y-4 rounded-lg border border-border bg-muted/10 p-4",children:[(0,s.jsxs)("header",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:"Telegram Bridge"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Configure optional Telegram notifications via bot API."})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:"Enabled"}),(0,s.jsx)(S,{checked:p,onCheckedChange:e=>i("telegram_enabled",e?"true":"false"),"aria-label":"Toggle Telegram notifications"})]})]}),(0,s.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"API Base"}),(0,s.jsx)(N,{value:r.telegram_api_base,onChange:e=>i("telegram_api_base",e.target.value),disabled:!p,placeholder:"https://api.telegram.org"})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Bot Token"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(N,{type:x?"text":"password",value:r.telegram_bot_token,onChange:e=>i("telegram_bot_token",e.target.value),disabled:!p,placeholder:"123456:ABC-DEF...",className:"pr-10"}),(0,s.jsx)(v.z,{type:"button",variant:"ghost",size:"icon",onClick:()=>g(e=>!e),disabled:!p,className:"absolute right-1.5 top-1/2 -translate-y-1/2","aria-label":x?"Hide bot token":"Show bot token",children:x?(0,s.jsx)(F.Z,{className:"h-4 w-4"}):(0,s.jsx)(V.Z,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Default Chat ID"}),(0,s.jsx)(N,{value:r.telegram_chat_id,onChange:e=>i("telegram_chat_id",e.target.value),disabled:!p,placeholder:"123456789"})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Parse Mode"}),(0,s.jsxs)("select",{value:r.telegram_parse_mode,onChange:e=>i("telegram_parse_mode",e.target.value),disabled:!p,className:"h-10 w-full rounded-md border border-input bg-background px-3 text-sm text-foreground shadow-sm transition focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",children:[(0,s.jsx)("option",{value:"",children:"None"}),(0,s.jsx)("option",{value:"Markdown",children:"Markdown"}),(0,s.jsx)("option",{value:"MarkdownV2",children:"MarkdownV2"}),(0,s.jsx)("option",{value:"HTML",children:"HTML"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Forward SMS to Telegram"}),(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3 rounded-md border border-input bg-background px-3 py-2 text-xs shadow-sm",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Use server polling to push unread SMS messages to Telegram."}),(0,s.jsx)(S,{checked:f,onCheckedChange:e=>i("long_polling_forward_sms_to_telegram",e?"true":"false"),disabled:!p||!h,"aria-label":"Toggle forwarding SMS to Telegram",title:h?void 0:"Enable server polling to forward SMS to Telegram."})]}),!h&&(0,s.jsx)("p",{className:"text-[11px] text-muted-foreground",children:"Enable server polling to forward SMS messages to Telegram."})]})]})]})]}),(0,s.jsxs)($,{className:"gap-2",children:[(0,s.jsx)(v.z,{type:"button",variant:"outline",disabled:c,onClick:n,children:"Cancel"}),(0,s.jsx)(v.z,{type:"submit",disabled:c,children:c?"Saving…":"Save changes"})]})]})]})})}function es(e){var a,t,l,n,r,i,d,o,c,u,m,x,g,p,f,b,j,N,y,w,S,_;let{open:C,onClose:k,preloginStatus:M,wanStatus:D}=e;if(!C)return null;let T=null!==(u=null==M?void 0:null===(l=M.wan_conns)||void 0===l?void 0:null===(t=l[0])||void 0===t?void 0:null===(a=t.ipConns)||void 0===a?void 0:a[0])&&void 0!==u?u:{},B=null!==(m=null==M?void 0:null===(n=M.root_info)||void 0===n?void 0:n[0])&&void 0!==m?m:{},E=null!==(x=null==D?void 0:null===(d=D.wan_conns)||void 0===d?void 0:null===(i=d[0])||void 0===i?void 0:null===(r=i.ipConns)||void 0===r?void 0:r[0])&&void 0!==x?x:{},I=null!==(p=null!==(g=E.DefaultGateway)&&void 0!==g?g:T.DefaultGateway)&&void 0!==p?p:"—",U=null!==(f=(0,h.SR)(M))&&void 0!==f?f:"—",R=null!==(j=null!==(b=E.X_CT_COM_IPv6IPAddress)&&void 0!==b?b:T.X_CT_COM_IPv6IPAddress)&&void 0!==j?j:"—",A=(T.DNSServers||"").split(/[ ,\n]+/).map(e=>e.trim()).filter(Boolean),P=A.length>0?A.join(", "):"Not provided",z=null!==(N=null==B?void 0:B.RootMacAddress)&&void 0!==N?N:"—",L=null!==(y=null==M?void 0:null===(c=M.device_cfg)||void 0===c?void 0:null===(o=c[0])||void 0===o?void 0:o.X_ALU_COM_LastActiveTime)&&void 0!==y?y:null,O=(0,h._o)(L),F="string"==typeof L&&""!==L.trim()&&"—"!==O&&O!==L?"".concat(O," • ").concat(L):O,V=[{label:"Connection",value:null!==(w=T.Name)&&void 0!==w?w:"—"},{label:"Status",value:null!==(_=null!==(S=E.ConnectionStatus)&&void 0!==S?S:T.ConnectionStatus)&&void 0!==_?_:"Unknown"},{label:"External IPv4",value:U},{label:"External IPv6",value:R},{label:"Gateway",value:null!=I?I:"—"},{label:"DNS Servers",value:P},{label:"MAC Address",value:z},{label:"Session Length",value:F}];return(0,s.jsx)(Z,{open:C,onOpenChange:e=>{e||k()},children:(0,s.jsxs)(X,{children:[(0,s.jsxs)(q,{children:[(0,s.jsx)(Y,{children:"WAN Connection Details"}),(0,s.jsx)(J,{children:"Connection properties reported by the modem."})]}),(0,s.jsx)(Q,{className:"max-h-[60vh] space-y-4 overflow-y-auto pr-1",children:(0,s.jsx)("div",{className:"grid gap-4 text-sm sm:grid-cols-2",children:V.map(e=>(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:e.label}),(0,s.jsx)("p",{className:"text-sm text-foreground",children:e.value})]},e.label))})}),(0,s.jsx)($,{children:(0,s.jsx)(v.z,{variant:"outline",onClick:k,children:"Close"})})]})})}ea.displayName=K.gb.displayName;var en=t(28004),er=t(68595);let ei=null!==(l=t(20357).env.NEXT_PUBLIC_API_BASE_URL)&&void 0!==l?l:"";async function ed(e){let a=await fetch("".concat(ei).concat(e),{cache:"no-store"});if(!a.ok)throw Error("Request to ".concat(e," failed with ").concat(a.status));return await a.json()}function eo(){var e,a,t;let[l,u]=(0,o.useState)({}),[m,x]=(0,o.useState)(!0),[g,p]=(0,o.useState)(null),[b,j]=(0,o.useState)(1e3),[N,y]=(0,o.useState)(null),[w,S]=(0,o.useState)(!1),[_,C]=(0,o.useState)(0),[M,D]=(0,o.useState)(!1),[T,B]=(0,o.useState)(!1),[E,I]=(0,o.useState)(null),[U,R]=(0,o.useState)(!1),[A,P]=(0,o.useState)(null),[z,L]=(0,o.useState)(!1),[O,F]=(0,o.useState)(null),[V,W]=(0,o.useState)(!1),[Z,H]=(0,o.useState)(!1),[G,X]=(0,o.useState)(""),[q,Y]=(0,o.useState)(!1),[J,Q]=(0,o.useState)(!1),[$,K]=(0,o.useState)(!1),[ee,ea]=(0,o.useState)(!0),eo=(0,o.useCallback)(e=>{var a;let t="success"===e.tone?c.Am.success:"error"===e.tone?c.Am.error:c.Am.info,l=null!==(a=e.title)&&void 0!==a?a:e.message,s=e.title?e.message:void 0;t(l,s?{description:s}:void 0)},[]);(0,o.useEffect)(()=>{let e=window.localStorage.getItem("pollingEnabled");null!==e&&ea("true"===e)},[]);let em=(0,o.useCallback)(async e=>{if(!z){L(!0);try{let a=await fetch("".concat(ei,"/api/led_state"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enable:e})});if(!a.ok)throw Error("LED update failed (".concat(a.status,")"));P(e),u(a=>({...a,ledState:e})),eo({tone:"success",message:e?"Device LEDs enabled.":"Device LEDs disabled."})}catch(e){eo({tone:"error",message:e.message||"Unable to change LED state."})}finally{L(!1)}}},[z,eo]),ex=(0,o.useCallback)(async()=>{if(!q){Y(!0),eo({tone:"info",message:"Renewing WAN IP…"});try{let e=(0,h.SR)(l.preloginStatus);await ec("/api/set_apn?apn=internet"),await eu(1e3),await ec("/api/set_apn?apn=xlunlimited"),await eu(1e3);let a=null,t=l.preloginStatus;for(let l=0;l<30&&(t=await ed("/api/prelogin_status"),!(a=(0,h.SR)(t))||a===e);l+=1)await eu(1e3);a&&a!==e?(eo({tone:"success",message:"New WAN IP acquired: ".concat(a)}),u(e=>({...e,preloginStatus:t}))):eo({tone:"error",message:"Unable to obtain a new WAN IP. Please try again later."})}catch(e){eo({tone:"error",message:e.message||"WAN IP renewal failed."})}finally{Y(!1),C(Date.now())}}},[l.preloginStatus,q,eo]),eg=(0,o.useCallback)(async()=>{if(!J){Q(!0),eo({tone:"info",message:"Sending reboot command…"});try{await ed("/api/do_reboot"),eo({tone:"success",message:"Reboot command sent. Modem is restarting."})}catch(e){eo({tone:"error",message:e.message||"Unable to reboot the device."})}finally{Q(!1)}}},[J,eo]),ep=(0,o.useCallback)(async e=>{if(!$){K(!0);try{var a;let t=Math.max(Date.now(),(null!==(a=l.dataExpired)&&void 0!==a?a:0)*1e3),s=Math.floor((t+1e3*e)/1e3);await ec("/api/set_data_expired?data_expired=".concat(s)),u(e=>({...e,dataExpired:s})),eo({tone:"success",message:"Data expiration updated."})}catch(e){eo({tone:"error",message:e.message||"Failed to update data expiration."})}finally{K(!1)}}},[l.dataExpired,$,eo]),eh=(0,o.useCallback)(async e=>{if(e.preventDefault(),$)return;if(!G){eo({tone:"error",message:"Please pick a date first."});return}let a=new Date("".concat(G,"T00:00:00"));if(Number.isNaN(a.getTime())){eo({tone:"error",message:"Invalid date format."});return}K(!0);try{let e=Math.floor(a.getTime()/1e3);await ec("/api/set_data_expired?data_expired=".concat(e)),u(a=>({...a,dataExpired:e})),X(""),eo({tone:"success",message:"Expiration date saved."})}catch(e){eo({tone:"error",message:e.message||"Failed to save expiration date."})}finally{K(!1)}},[G,$,eo]),ef=(0,o.useCallback)(async()=>{if(!V){W(!0);try{let e=await ed("/api/sms");u(a=>({...a,sms:(0,h.EE)(e)}))}catch(e){eo({tone:"error",message:e.message||"Unable to refresh SMS inbox."})}finally{W(!1)}}},[V,eo]),ev=(0,o.useCallback)(async(e,a)=>{if(!V){W(!0);try{let t="/api/set_sms_state?smsid=".concat(encodeURIComponent(e.SMSID),"&smsunread=").concat(a?1:0);await ed(t),u(t=>{var l;return{...t,sms:null===(l=t.sms)||void 0===l?void 0:l.map(t=>t.SMSID===e.SMSID?{...t,SMSUnread:a}:t)}})}catch(e){eo({tone:"error",message:e.message||"Unable to update SMS state."})}finally{W(!1)}}},[V,eo]),eb=(0,o.useCallback)(async e=>{if(!V){W(!0);try{let a=await fetch("".concat(ei,"/api/delete_sms"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sms_ids:[e]})});if(!a.ok)throw Error("Failed to delete SMS (".concat(a.status,")"));u(a=>{var t;return{...a,sms:null===(t=a.sms)||void 0===t?void 0:t.filter(a=>a.SMSID!==e)}}),F(a=>a===e?null:a),eo({tone:"success",message:"SMS deleted."})}catch(e){eo({tone:"error",message:e.message||"Unable to delete SMS."})}finally{W(!1)}}},[V,eo]),ej=(0,o.useCallback)(()=>{l.config&&I((0,h.SD)(l.config,1e3)),D(!0)},[l.config]),eN=(0,o.useCallback)((e,a)=>{I(t=>t?{...t,[e]:a}:t)},[]),ey=(0,o.useCallback)(async e=>{if(e.preventDefault(),E&&!U){R(!0);try{await ed("/api/config/listener_available?host=".concat(encodeURIComponent(E.listen_host),"&port=").concat(encodeURIComponent(E.listen_port)));let e=(()=>{let e=Number(E.poll_interval_ms);return Number.isFinite(e)&&e>0?Math.max(500,e):1e3})(),a=(()=>{let e=Number(E.long_polling_interval_seconds);return Number.isFinite(e)&&e>0?Math.max(5,Math.floor(e)):10})(),t={router_host:E.router_host,router_user:E.router_user,router_password:E.router_password,listen_host:E.listen_host,listen_port:E.listen_port,poll_interval_ms:e,telegram:{enabled:"true"===E.telegram_enabled,api_base:E.telegram_api_base.trim(),bot_token:E.telegram_bot_token.trim(),chat_id:E.telegram_chat_id.trim(),parse_mode:E.telegram_parse_mode.trim()},long_polling:{enabled:"true"===E.long_polling_enabled,forward_sms_to_telegram:"true"===E.long_polling_forward_sms_to_telegram,interval_seconds:a}},l=await fetch("".concat(ei,"/api/config"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((null==e?void 0:e.error)||"Config save failed (".concat(l.status,")"))}eo({tone:"success",message:"Configuration saved."}),D(!1),C(Date.now())}catch(e){eo({tone:"error",message:e.message||"Unable to save configuration."})}finally{R(!1)}}},[E,U,eo]);(0,o.useEffect)(()=>{let e=!0,a=null,t=async()=>{try{S(!0);let[a,t,l,s,n,r,i,d,o,c,m,x,g]=await Promise.all([ed("/api/config"),ed("/api/prelogin_status"),ed("/api/status_web"),ed("/api/service_data"),ed("/api/cell_identification").catch(()=>null),ed("/api/device_status"),ed("/api/daily_usage"),ed("/api/get_data_expired").catch(()=>null),ed("/api/sms").catch(()=>null),ed("/api/wlan_configs_24g").catch(()=>null),ed("/api/wlan_configs_5g").catch(()=>null),ed("/api/wan_status").catch(()=>null),ed("/api/led_state").catch(()=>null)]);if(!e)return;let f=null!=a?a:{};u({config:f,preloginStatus:t,statusWeb:l,serviceData:s,cellIdentification:n,deviceStatus:r,dailyUsage:i,dataExpired:(0,h.GQ)(d),sms:(0,h.EE)(o),wlan24:c,wlan5:m,wanStatus:x,ledState:(0,h.Av)(g)}),P((0,h.Av)(g)),y(Date.now()),p(null);let v=Math.max(500,(0,h.Rg)(f,1e3));j(e=>e===v?e:v)}catch(a){var l;if(!e)return;p(null!==(l=a.message)&&void 0!==l?l:"Unable to load dashboard data.")}finally{if(!e)return;x(!1),S(!1),ee&&(a=setTimeout(t,b))}};return t(),()=>{e=!1,a&&clearTimeout(a)}},[b,_,ee]),(0,o.useEffect)(()=>{var e;if(!T)return;let a=null!==(e=l.sms)&&void 0!==e?e:[];if(0===a.length){F(null);return}F(e=>e&&a.some(a=>a.SMSID===e)?e:a[0].SMSID)},[l.sms,T]);let ew=(0,o.useMemo)(()=>Math.round(b/1e3),[b]),eS=null!==(a=null===(e=l.sms)||void 0===e?void 0:e.filter(e=>e.SMSUnread).length)&&void 0!==a?a:0,e_=(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(v.z,{type:"button",variant:ee?"secondary":"outline",size:"sm",onClick:()=>ea(e=>{let a=!e;return window.localStorage.setItem("pollingEnabled",String(a)),window.dispatchEvent(new CustomEvent("polling:change",{detail:{enabled:a}})),a}),className:"h-9 gap-2 px-3",children:[(0,s.jsx)("span",{className:"h-2 w-2 rounded-full ".concat(ee?"bg-emerald-400 animate-pulse":"bg-muted-foreground")}),"Polling ",ee?"On":"Off"]}),(0,s.jsx)(v.z,{type:"button",variant:"outline",size:"icon",onClick:()=>{C(Date.now())},disabled:w,"aria-label":w?"Refreshing":"Refresh",children:w?(0,s.jsx)(n.Z,{className:"h-4 w-4 animate-spin"}):(0,s.jsx)(r.Z,{className:"h-4 w-4"})}),(0,s.jsxs)(v.z,{type:"button",variant:"outline",size:"icon",onClick:()=>B(!0),className:"relative","aria-label":"SMS Inbox",children:[(0,s.jsx)(i.Z,{className:"h-4 w-4"}),eS>0?(0,s.jsx)(f.C,{variant:"destructive",className:"absolute -right-1 -top-1 h-5 min-w-[1.25rem] rounded-full px-1 py-0 text-[10px]",children:eS}):null]}),(0,s.jsx)(v.z,{type:"button",variant:"outline",size:"icon",onClick:ej,"aria-label":"Configuration",children:(0,s.jsx)(d.Z,{className:"h-4 w-4"})})]});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(en.V,{toolbar:e_,children:[(0,s.jsx)("section",{className:"space-y-4",children:(0,s.jsx)(er.m,{eyebrow:"Nokia FastMile 5G Gateway 2",title:"Modem Dashboard",description:(0,s.jsxs)(s.Fragment,{children:["Live signal metrics, traffic usage, device health, and connected clients. Data refreshes automatically every ",ew," second",1===ew?"":"s","."]})})}),g&&(0,s.jsx)("div",{className:"rounded-lg border border-red-500/60 bg-red-500/10 px-4 py-3 text-sm text-red-200",children:g}),m?(0,s.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((e,a)=>(0,s.jsx)("div",{className:"h-48 animate-pulse rounded-xl border border-neutral-800 bg-neutral-900/60"},a))}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(k,{data:l,ledEnabled:A,ledBusy:z,onToggleLed:em,onRenewIp:ex,renewing:q,onReboot:eg,rebooting:J,onOpenWanDetails:()=>H(!0),onExtendData:ep,onCustomExpirySubmit:eh,onCustomExpiryChange:e=>X(e),customExpiry:G,expiryBusy:$}),(0,s.jsxs)("footer",{className:"flex flex-col gap-1 text-xs text-neutral-500 md:flex-row md:items-center md:justify-between",children:[(0,s.jsxs)("span",{children:["Last updated:"," ",N?new Date(N).toLocaleString():"—"]}),(0,s.jsxs)("span",{children:["Poll interval: ",ew," second",1===ew?"":"s"]})]})]})]}),(0,s.jsx)(et,{open:T,onClose:()=>B(!1),messages:null!==(t=l.sms)&&void 0!==t?t:[],busy:V,onRefresh:ef,onMarkRead:ev,onDelete:eb,selectedSmsId:O,onSelect:F}),(0,s.jsx)(el,{open:M,onClose:()=>D(!1),draft:E,onChange:eN,onSubmit:ey,saving:U}),(0,s.jsx)(es,{open:Z,onClose:()=>H(!1),preloginStatus:l.preloginStatus,wanStatus:l.wanStatus})]})}async function ec(e){let a=await fetch("".concat(ei).concat(e));if(!a.ok)throw Error("Request to ".concat(e," failed with ").concat(a.status));await a.json().catch(()=>null)}async function eu(e){return new Promise(a=>setTimeout(a,e))}}},function(e){e.O(0,[182,776,299,897,971,23,744],function(){return e(e.s=93145)}),_N_E=e.O()}]);