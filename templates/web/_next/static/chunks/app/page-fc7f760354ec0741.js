(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7162:function(e,t,l){Promise.resolve().then(l.bind(l,4559))},4559:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return A}});var a,n=l(7437),s=l(7138),r=l(2265),i=l(5502),o=l(7104),d=l(4110);function c(e){let{title:t,subtitle:l,action:a,children:s}=e;return(0,n.jsxs)("article",{className:"rounded-xl border border-neutral-800 bg-neutral-900/60 p-6",children:[(0,n.jsxs)("header",{className:"mb-4 flex items-start justify-between gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-base font-semibold text-white",children:t}),l?(0,n.jsx)("p",{className:"mt-1 text-xs text-neutral-500",children:l}):null]}),a]}),(0,n.jsx)("div",{className:"space-y-3 text-sm text-neutral-200",children:s})]})}function u(e){let{children:t,ariaLabel:l,onClick:a,disabled:s}=e;return(0,n.jsx)("button",{type:"button","aria-label":l,onClick:a,disabled:s,className:"relative flex h-10 w-10 items-center justify-center rounded-full border border-neutral-800 bg-neutral-900/60 text-sm text-neutral-300 transition hover:border-neutral-600 hover:text-white disabled:cursor-not-allowed disabled:opacity-60",children:t})}function x(e){let{data:t,ledEnabled:l,ledBusy:a,onToggleLed:s,onRenewIp:r,renewing:i,onReboot:o,rebooting:d,onOpenWanDetails:c,onExtendData:u,onCustomExpirySubmit:x,onCustomExpiryChange:h,customExpiry:N,expiryBusy:w}=e;return(0,n.jsxs)("div",{className:"grid gap-6 xl:grid-cols-[1.2fr,1fr]",children:[(0,n.jsxs)("section",{className:"grid gap-6",children:[(0,n.jsx)(m,{statusWeb:t.statusWeb,serviceData:t.serviceData,cellIdentification:t.cellIdentification,wanStatus:t.wanStatus,preloginStatus:t.preloginStatus,onOpenWanDetails:c}),(0,n.jsx)(p,{dailyUsage:t.dailyUsage}),(0,n.jsx)(j,{dataExpired:t.dataExpired,onExtendThirtyDays:()=>u(2592e3),onSubmit:x,onDateChange:h,dateValue:N,busy:w})]}),(0,n.jsxs)("section",{className:"grid gap-6",children:[(0,n.jsx)(v,{ledEnabled:l,ledBusy:a,onToggleLed:s,onRenewIp:r,renewing:i,onReboot:o,rebooting:d,onOpenWanDetails:c}),(0,n.jsx)(b,{deviceStatus:t.deviceStatus}),(0,n.jsx)(g,{wlan24:t.wlan24,wlan5:t.wlan5}),(0,n.jsx)(f,{preloginStatus:t.preloginStatus})]})]})}function m(e){var t,l,a,s,u,x,m,b,p,v,g,f,j,w,y,S,_,C,D,k,M,I,E,R,A,U,P,T,L,B;let{statusWeb:O,serviceData:F,cellIdentification:W,wanStatus:G,preloginStatus:X,onOpenWanDetails:z}=e,q=null!==(j=null==O?void 0:null===(l=O.cell_LTE_stats_cfg)||void 0===l?void 0:null===(t=l[0])||void 0===t?void 0:t.stat)&&void 0!==j?j:{},H=[{label:"Band",value:q.Band},{label:"PCI",value:q.PhysicalCellID},{label:"EARFCN",value:q.DownlinkEarfcn},{label:"ECI",value:q.ECI}],V=[{label:"RSRP",value:(0,o.$2)(q.RSRPCurrent,"dBm"),percent:(0,o.gb)(q.RSRPCurrent,-140,-64)},{label:"RSRQ",value:(0,o.$2)(q.RSRQCurrent,"dB"),percent:(0,o.gb)(q.RSRQCurrent,-20,-3)},{label:"SNR",value:(0,o.$2)(q.SNRCurrent,"dB"),percent:(0,o.gb)(q.SNRCurrent,-10,30)},{label:"RSSI",value:(0,o.$2)(q.RSSICurrent,"dBm"),percent:(0,o.gb)(q.RSSICurrent,-120,-30)}],{downlink:Q,uplink:$}=(0,r.useMemo)(()=>{var e;let t=e=>Array.isArray(e)?e:e&&"object"==typeof e?Object.values(e):[],l=null!==(e=null==F?void 0:F.FunctionResult)&&void 0!==e?e:{};return{downlink:t(null==l?void 0:l.LTEDLCA),uplink:t(null==l?void 0:l.LTEULCA)}},[F]),J=(null!==(w=null==Q?void 0:Q.length)&&void 0!==w?w:0)>0||(null!==(y=null==$?void 0:$.length)&&void 0!==y?y:0)>0,Y=null!==(C=null!==(_=null!==(S=null==W?void 0:null===(a=W.FunctionResult)||void 0===a?void 0:a.Name)&&void 0!==S?S:null==W?void 0:W.Name)&&void 0!==_?_:null==W?void 0:null===(s=W.functionResult)||void 0===s?void 0:s.Name)&&void 0!==C?C:null,K=null!==(D=null==X?void 0:null===(m=X.wan_conns)||void 0===m?void 0:null===(x=m[0])||void 0===x?void 0:null===(u=x.ipConns)||void 0===u?void 0:u[0])&&void 0!==D?D:{},Z=null!==(k=null==G?void 0:null===(v=G.wan_conns)||void 0===v?void 0:null===(p=v[0])||void 0===p?void 0:null===(b=p.ipConns)||void 0===b?void 0:b[0])&&void 0!==k?k:{},ee=null!==(M=(0,o.SR)(X))&&void 0!==M?M:"—",et=null!==(E=null!==(I=Z.X_CT_COM_IPv6IPAddress)&&void 0!==I?I:K.X_CT_COM_IPv6IPAddress)&&void 0!==E?E:"—",el=null!==(R=null==K?void 0:K.DNSServers)&&void 0!==R?R:"—",ea=null!==(A=null==K?void 0:K.X_CT_COM_IPv6DNSServers)&&void 0!==A?A:"—",en=null!==(P=null!==(U=Z.DefaultGateway)&&void 0!==U?U:K.DefaultGateway)&&void 0!==P?P:"—",es=null!==(L=null!==(T=Z.ConnectionStatus)&&void 0!==T?T:K.ConnectionStatus)&&void 0!==L?L:"Unknown",er=null!==(B=null==X?void 0:null===(f=X.device_cfg)||void 0===f?void 0:null===(g=f[0])||void 0===g?void 0:g.X_ALU_COM_LastActiveTime)&&void 0!==B?B:null,ei=(0,o._o)(er),eo="string"==typeof er&&""!==er.trim()&&"—"!==ei&&ei!==er?"".concat(ei," • ").concat(er):ei;return(0,n.jsxs)(c,{title:(0,n.jsx)(n.Fragment,{children:Y?(0,n.jsx)("span",{className:"text-base font-semibold text-white",children:Y}):"LTE Signal"}),children:[(0,n.jsxs)(i.fC,{defaultValue:"signal",className:"space-y-3",children:[(0,n.jsxs)(i.aV,{className:"inline-flex w-full items-center gap-1 rounded-lg border border-neutral-800 bg-neutral-900/60 p-0.5 text-xs font-semibold uppercase tracking-wide",children:[(0,n.jsx)(i.xz,{value:"signal",className:"flex-1 rounded-md px-3 py-1 text-neutral-400 transition hover:text-white data-[state=active]:bg-neutral-800 data-[state=active]:text-white",children:"Signal"}),(0,n.jsx)(i.xz,{value:"ca",className:"flex-1 rounded-md px-3 py-1 text-neutral-400 transition hover:text-white data-[state=active]:bg-neutral-800 data-[state=active]:text-white",children:"Carrier Agg."})]}),(0,n.jsxs)(i.VY,{value:"signal",className:"space-y-3",children:[(0,n.jsx)("div",{className:"grid grid-cols-1 gap-2 text-sm text-neutral-400",children:(0,n.jsx)("span",{className:"font-semibold text-neutral-500",children:"Main Signal"})}),(0,n.jsx)("div",{className:"grid grid-cols-2 gap-2 text-xs text-neutral-400",children:H.map(e=>{let{label:t,value:l}=e;return(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsx)("span",{className:"font-semibold text-neutral-500",children:t}),(0,n.jsx)("span",{className:"text-sm text-neutral-200",children:null!=l?l:"—"})]},t)})}),(0,n.jsx)("hr",{className:"border-neutral-800"}),(0,n.jsx)("div",{className:"space-y-3 text-xs text-neutral-400",children:V.map(e=>{let{label:t,value:l,percent:a}=e;return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"mb-1.5 flex items-center justify-between",children:[(0,n.jsx)("span",{className:"font-semibold text-neutral-500",children:t}),(0,n.jsx)("span",{className:"text-sm text-neutral-200",children:l})]}),(0,n.jsx)(d.E,{value:a,className:"h-1.5 bg-neutral-800"})]},t)})})]}),(0,n.jsx)(i.VY,{value:"ca",className:"space-y-3",children:J?(0,n.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,n.jsx)(h,{title:"Downlink",carriers:Q}),(0,n.jsx)(h,{title:"Uplink",carriers:$})]}):(0,n.jsx)("p",{className:"text-xs text-neutral-500",children:"Carrier aggregation data is not available."})})]}),(0,n.jsx)("hr",{className:"border-neutral-800"}),(0,n.jsxs)("div",{className:"space-y-2 text-xs text-neutral-400",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"font-semibold text-white",children:"Connection Summary"}),(0,n.jsx)("button",{type:"button",onClick:z,className:"text-[11px] font-semibold text-blue-400 transition hover:text-blue-300",children:"View details"})]}),(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsx)(N,{label:"External IPv4",value:ee}),(0,n.jsx)(N,{label:"External IPv6",value:et}),(0,n.jsx)(N,{label:"Gateway",value:en}),(0,n.jsx)(N,{label:"DNSv4",value:el}),(0,n.jsx)(N,{label:"DNSv6",value:ea}),(0,n.jsx)(N,{label:"Status",value:es}),(0,n.jsx)(N,{label:"Session",value:eo})]})]})]})}function b(e){var t,l,a,s,r,i,d;let{deviceStatus:u}=e,x=null!==(s=null==u?void 0:u.UpTime)&&void 0!==s?s:0,m=null!==(r=null==u?void 0:null===(t=u.cpu_usageinfo)||void 0===t?void 0:t.CPUUsage)&&void 0!==r?r:null,b=null!==(i=null==u?void 0:null===(l=u.mem_info)||void 0===l?void 0:l.Total)&&void 0!==i?i:0,p=null!==(d=null==u?void 0:null===(a=u.mem_info)||void 0===a?void 0:a.Free)&&void 0!==d?d:0,h=b>0?Math.round((b-p)/b*100):0;return(0,n.jsx)(c,{title:"Device Health",children:(0,n.jsxs)("div",{className:"grid gap-3",children:[(0,n.jsx)(N,{label:"Uptime",value:(0,o.d5)(x)}),(0,n.jsx)(N,{label:"CPU Usage",value:null!==m?"".concat(m,"%"):"—",highlight:null!==m}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between text-xs text-neutral-400",children:[(0,n.jsx)("span",{className:"font-semibold text-neutral-500",children:"Memory Usage"}),(0,n.jsxs)("span",{className:"text-neutral-200",children:[h,"%"]})]}),(0,n.jsx)("div",{className:"mt-2 h-2 w-full rounded-full bg-neutral-800",children:(0,n.jsx)("div",{className:"h-2 rounded-full bg-blue-500 transition-all",style:{width:"".concat(h,"%")}})})]})]})})}function p(e){var t,l,a,s,r,i,d;let{dailyUsage:u}=e,x=null!==(s=null==u?void 0:null===(t=u.total_usage)||void 0===t?void 0:t.download)&&void 0!==s?s:"0 B",m=null!==(r=null==u?void 0:null===(l=u.total_usage)||void 0===l?void 0:l.upload)&&void 0!==r?r:"0 B",b=null!==(i=null==u?void 0:null===(a=u.total_usage)||void 0===a?void 0:a.combined)&&void 0!==i?i:"0 B",p=null!==(d=null==u?void 0:u.last_7_days)&&void 0!==d?d:[];return(0,n.jsxs)(c,{title:"Data Usage (Last 7 Days)",subtitle:"Aggregated cellular traffic collected from the modem",action:(0,n.jsx)(y,{href:"/report",children:"Full report"}),children:[(0,n.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-xs text-neutral-500",children:[(0,n.jsx)(w,{label:"Download",value:x,tone:"blue"}),(0,n.jsx)(w,{label:"Upload",value:m,tone:"green"}),(0,n.jsx)(w,{label:"Total",value:b,tone:"neutral"})]}),(0,n.jsx)("div",{className:"overflow-hidden rounded-lg border border-neutral-800",children:(0,n.jsxs)("table",{className:"min-w-full divide-y divide-neutral-800 text-xs",children:[(0,n.jsx)("thead",{className:"bg-neutral-900/80 text-neutral-400",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-4 py-2 text-left font-semibold",children:"Date"}),(0,n.jsx)("th",{className:"px-4 py-2 text-right font-semibold",children:"Download"}),(0,n.jsx)("th",{className:"px-4 py-2 text-right font-semibold",children:"Upload"}),(0,n.jsx)("th",{className:"px-4 py-2 text-right font-semibold",children:"Total"}),(0,n.jsx)("th",{className:"px-4 py-2 text-right font-semibold",children:"Share"})]})}),(0,n.jsx)("tbody",{className:"divide-y divide-neutral-800 text-neutral-200",children:0===p.length?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:5,className:"px-4 py-4 text-center text-xs text-neutral-500",children:"No usage history recorded yet."})}):p.map(e=>{var t,l,a,s,r,i,d;return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"px-4 py-2",children:(0,o.p6)(e.date)}),(0,n.jsx)("td",{className:"px-4 py-2 text-right text-blue-300",children:null!==(r=null===(t=e.download)||void 0===t?void 0:t.formatted)&&void 0!==r?r:"0 B"}),(0,n.jsx)("td",{className:"px-4 py-2 text-right text-green-300",children:null!==(i=null===(l=e.upload)||void 0===l?void 0:l.formatted)&&void 0!==i?i:"0 B"}),(0,n.jsx)("td",{className:"px-4 py-2 text-right font-semibold",children:null!==(d=null===(a=e.combined)||void 0===a?void 0:a.formatted)&&void 0!==d?d:"0 B"}),(0,n.jsx)("td",{className:"px-4 py-2 text-right text-neutral-400",children:(0,o.rl)(null===(s=e.combined)||void 0===s?void 0:s.percentage)})]},e.date)})})]})})]})}function h(e){let{title:t,carriers:l}=e;return l&&0!==l.length?(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wide text-neutral-500",children:t}),(0,n.jsx)("ul",{className:"mt-3 space-y-3 text-xs text-neutral-300",children:l.map((e,l)=>{var a,s,r,i;return(0,n.jsx)("li",{className:"rounded-lg border border-neutral-800 bg-neutral-900/50 p-3",children:(0,n.jsxs)("div",{className:"grid grid-cols-[1fr,auto] gap-2",children:[(0,n.jsx)("span",{className:"text-neutral-500",children:"Band"}),(0,n.jsx)("span",{className:"text-neutral-200",children:null!==(a=e.ScellBand)&&void 0!==a?a:"—"}),(0,n.jsx)("span",{className:"text-neutral-500",children:"Bandwidth"}),(0,n.jsx)("span",{className:"text-neutral-200",children:null!==(s=e.ScellBandwidth)&&void 0!==s?s:"—"}),(0,n.jsx)("span",{className:"text-neutral-500",children:"PCI"}),(0,n.jsx)("span",{className:"text-neutral-200",children:null!==(r=e.PhysicalCellID)&&void 0!==r?r:"—"}),(0,n.jsx)("span",{className:"text-neutral-500",children:"EARFCN"}),(0,n.jsx)("span",{className:"text-neutral-200",children:null!==(i=e.ScellChannel)&&void 0!==i?i:"—"})]})},"".concat(t,"-").concat(l))})})]}):(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wide text-neutral-500",children:t}),(0,n.jsx)("p",{className:"mt-2 text-xs text-neutral-500",children:"No carriers detected."})]})}function v(e){let{ledEnabled:t,ledBusy:l,onToggleLed:a,onRenewIp:s,renewing:r,onReboot:i,rebooting:o,onOpenWanDetails:d}=e,u=null===t||!t;return(0,n.jsx)(c,{title:"Controls & Actions",children:(0,n.jsxs)("div",{className:"space-y-4 text-xs",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between gap-3 rounded-lg border border-neutral-800 bg-neutral-900/40 p-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-semibold text-white",children:"Device LEDs"}),(0,n.jsx)("p",{className:"mt-1 text-neutral-400",children:"Toggle the led indicators for a quieter environment."})]}),(0,n.jsx)("button",{type:"button",onClick:()=>a(u),disabled:l,className:"relative inline-flex h-6 w-12 items-center rounded-full px-1 transition ".concat(t?"bg-blue-500":"bg-neutral-700"," disabled:cursor-not-allowed disabled:opacity-60"),children:(0,n.jsx)("span",{className:"h-4 w-4 rounded-full bg-white transition ".concat(t?"translate-x-6":"translate-x-0")})})]}),(0,n.jsxs)("div",{className:"grid gap-3",children:[(0,n.jsx)("button",{type:"button",onClick:s,disabled:r,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-blue-500 disabled:cursor-not-allowed disabled:bg-blue-600/50",children:r?"Renewing…":"Renew WAN IP"}),(0,n.jsx)("button",{type:"button",onClick:i,disabled:o,className:"rounded-lg bg-red-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-red-500 disabled:cursor-not-allowed disabled:bg-red-600/50",children:o?"Rebooting…":"Reboot modem"}),(0,n.jsx)("button",{type:"button",onClick:d,className:"rounded-lg border border-neutral-700 px-4 py-2 text-sm font-semibold text-neutral-200 transition hover:border-neutral-500 hover:text-white",children:"WAN details"})]})]})})}function g(e){var t,l,a,s,r,i;let{wlan24:d,wlan5:u}=e,x=[{label:"2.4 GHz",config:null!==(s=null==d?void 0:null===(t=d.wlan_config_glb)||void 0===t?void 0:t[0])&&void 0!==s?s:null},{label:"5 GHz",config:null!==(i=null!==(r=null==u?void 0:null===(l=u.wlan_config_glb11ac)||void 0===l?void 0:l[0])&&void 0!==r?r:null==u?void 0:null===(a=u.wlan_config_glb)||void 0===a?void 0:a[0])&&void 0!==i?i:null}];return(0,n.jsx)(c,{title:"Wi-Fi Radios",subtitle:"SSID, channel, and security overview",children:(0,n.jsx)("div",{className:"space-y-3 text-xs",children:x.map(e=>{var t,l,a,s;let{label:r,config:i}=e,d=(0,o.sw)(null==i?void 0:i.Enable);return(0,n.jsxs)("div",{className:"rounded-lg border border-neutral-800 bg-neutral-900/40 p-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-semibold text-white",children:null!==(t=null==i?void 0:i.SSID)&&void 0!==t?t:"—"}),(0,n.jsx)("p",{className:"text-neutral-500",children:r})]}),(0,n.jsx)("span",{className:"rounded-full px-3 py-1 text-[11px] font-semibold ".concat(d?"bg-green-600/20 text-green-300":"bg-neutral-700 text-neutral-300"),children:d?"Enabled":"Disabled"})]}),(0,n.jsxs)("dl",{className:"mt-3 grid grid-cols-2 gap-x-4 gap-y-1 text-neutral-400",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{children:"Mode"}),(0,n.jsx)("dd",{className:"text-neutral-200",children:null!==(l=null==i?void 0:i.X_ALU_COM_Mode)&&void 0!==l?l:"—"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{children:"Channel"}),(0,n.jsx)("dd",{className:"text-neutral-200",children:null!==(a=null==i?void 0:i.Channel)&&void 0!==a?a:"Auto"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{children:"Bandwidth"}),(0,n.jsx)("dd",{className:"text-neutral-200",children:null!==(s=null==i?void 0:i.X_ALU_COM_Bandwidth)&&void 0!==s?s:"—"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{children:"Security"}),(0,n.jsx)("dd",{className:"text-neutral-200",children:(0,o.FM)(i)})]})]})]},r)})})})}function f(e){let{preloginStatus:t}=e,l=(Array.isArray(null==t?void 0:t.device_cfg)?t.device_cfg:[]).filter(e=>1===e.Active),a=l.filter(e=>"Ethernet"===e.InterfaceType).length,s=l.filter(e=>"Ethernet"!==e.InterfaceType).length,r=l.slice(0,6).map(e=>{var t,l,a;return{id:null!==(a=null!==(l=null!==(t=e.MACAddress)&&void 0!==t?t:e.ID)&&void 0!==l?l:e.HostName)&&void 0!==a?a:Math.random().toString(36),name:e.HostName||e.Alias||"Unknown device",ip:e.IPAddress||"—",iface:e.InterfaceType||"Unknown"}});return(0,n.jsxs)(c,{title:"Connected Devices",subtitle:"Active devices reported by the modem",children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"rounded-lg border border-neutral-800 bg-neutral-900/40 p-4 text-center",children:[(0,n.jsx)("p",{className:"text-xs uppercase tracking-wide text-neutral-500",children:"Ethernet"}),(0,n.jsx)("p",{className:"mt-2 text-2xl font-semibold text-white",children:a})]}),(0,n.jsxs)("div",{className:"rounded-lg border border-neutral-800 bg-neutral-900/40 p-4 text-center",children:[(0,n.jsx)("p",{className:"text-xs uppercase tracking-wide text-neutral-500",children:"Wi-Fi"}),(0,n.jsx)("p",{className:"mt-2 text-2xl font-semibold text-white",children:s})]})]}),(0,n.jsx)("div",{className:"mt-4 space-y-2 text-xs",children:0===r.length?(0,n.jsx)("p",{className:"text-neutral-500",children:"No active clients detected."}):r.map(e=>(0,n.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-neutral-800 bg-neutral-900/40 px-3 py-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-semibold text-neutral-200",children:e.name}),(0,n.jsx)("p",{className:"text-[11px] text-neutral-500",children:e.ip})]}),(0,n.jsx)("span",{className:"text-[11px] uppercase tracking-wide text-neutral-500",children:e.iface})]},e.id))})]})}function j(e){let{dataExpired:t,onExtendThirtyDays:l,onSubmit:a,onDateChange:s,dateValue:i,busy:d}=e,u=(0,r.useMemo)(()=>{if(!t)return{label:"Not configured",tone:"neutral"};let e=new Date(1e3*t),l=new Date,a=Math.floor((e.getTime()-l.getTime())/864e5);return a<0?{label:"".concat((0,o.p6)(e.toISOString().slice(0,10))," (expired ").concat(Math.abs(a)," day").concat(-1===a?"":"s"," ago)"),tone:"danger"}:a<=3?{label:"".concat((0,o.p6)(e.toISOString().slice(0,10))," (").concat(a," day").concat(1===a?"":"s"," remaining)"),tone:"warning"}:{label:"".concat((0,o.p6)(e.toISOString().slice(0,10))," (").concat(a," day").concat(1===a?"":"s"," remaining)"),tone:"success"}},[t]),x="danger"===u.tone?"text-red-400":"warning"===u.tone?"text-yellow-400":"success"===u.tone?"text-green-400":"text-neutral-300";return(0,n.jsxs)(c,{title:"Data Expiration",subtitle:"Manage how long modem traffic counters remain valid",children:[(0,n.jsx)("p",{className:"text-sm font-semibold ".concat(x),children:u.label}),(0,n.jsxs)("form",{className:"mt-4 space-y-3 text-xs",onSubmit:a,children:[(0,n.jsxs)("label",{className:"flex flex-col gap-1 text-neutral-500",children:[(0,n.jsx)("span",{className:"font-semibold uppercase tracking-wide",children:"Expiration date"}),(0,n.jsx)("input",{type:"date",value:i,onChange:e=>s(e.target.value),disabled:d,className:"rounded-md border border-neutral-700 bg-neutral-900/70 px-3 py-2 text-sm text-neutral-200 outline-none transition focus:border-blue-500 focus:ring-1 focus:ring-blue-500 disabled:cursor-not-allowed disabled:opacity-60"})]}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)("button",{type:"button",onClick:l,disabled:d,className:"flex-1 rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-blue-500 disabled:cursor-not-allowed disabled:bg-blue-600/50",children:"Extend 30 Days"}),(0,n.jsx)("button",{type:"submit",disabled:d||!i,className:"flex-1 rounded-lg bg-green-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-green-500 disabled:cursor-not-allowed disabled:bg-green-600/50",children:"Save Date"})]})]})]})}function N(e){let{label:t,value:l,highlight:a}=e;return(0,n.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,n.jsx)("span",{className:"font-semibold text-neutral-500",children:t}),(0,n.jsx)("span",{className:a?"text-white":"text-neutral-300",children:l})]})}function w(e){let{label:t,value:l,tone:a}=e;return(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-neutral-500",children:t}),(0,n.jsx)("p",{className:"mt-1 text-sm font-semibold ".concat("blue"===a?"text-blue-300":"green"===a?"text-green-300":"text-neutral-200"),children:l})]})}function y(e){let{href:t,children:l}=e;return(0,n.jsx)(s.default,{href:t,className:"inline-flex items-center gap-2 rounded-lg border border-neutral-700 px-4 py-2 text-xs font-semibold text-neutral-200 transition hover:border-neutral-500 hover:text-white",children:l})}function S(e){let{toast:t,onDismiss:l}=e;if(!t)return null;let a="success"===t.tone?"border-green-600/60 bg-green-500/10 text-green-100":"error"===t.tone?"border-red-600/60 bg-red-500/10 text-red-100":"border-blue-600/60 bg-blue-500/10 text-blue-100";return(0,n.jsx)("div",{className:"pointer-events-none fixed inset-x-0 top-4 z-[1200] flex justify-center px-4",children:(0,n.jsxs)("div",{className:"pointer-events-auto flex w-full max-w-lg items-start gap-3 rounded-lg border px-4 py-3 shadow-lg transition ".concat(a),children:[(0,n.jsxs)("div",{className:"flex-1",children:[t.title?(0,n.jsx)("p",{className:"text-sm font-semibold",children:t.title}):null,(0,n.jsx)("p",{className:"text-sm",children:t.message})]}),(0,n.jsx)("button",{type:"button",onClick:l,className:"text-xs font-semibold uppercase tracking-wide text-neutral-200/80 transition hover:text-white",children:"Close"})]})})}function _(e){var t,l;let{open:a,onClose:s,messages:r,busy:i,onRefresh:d,onMarkRead:c,onDelete:u,selectedSmsId:x,onSelect:m}=e;if(!a)return null;let b=null!==(l=null!==(t=r.find(e=>e.SMSID===x))&&void 0!==t?t:r[0])&&void 0!==l?l:null;return(0,n.jsx)("div",{className:"fixed inset-0 z-[1150] flex items-center justify-center bg-black/70 px-4 py-8",children:(0,n.jsxs)("div",{className:"flex w-full max-w-4xl flex-col gap-4 rounded-xl border border-neutral-800 bg-neutral-950 p-6 shadow-2xl",children:[(0,n.jsxs)("header",{className:"flex items-start justify-between gap-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-white",children:"SMS Inbox"}),(0,n.jsxs)("p",{className:"text-xs text-neutral-500",children:[r.length," message",1===r.length?"":"s"," stored on the router."]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{type:"button",onClick:d,disabled:i,className:"rounded-lg border border-neutral-700 px-3 py-1.5 text-xs font-semibold text-neutral-200 transition hover:border-neutral-500 hover:text-white disabled:cursor-not-allowed disabled:opacity-60",children:"Refresh"}),(0,n.jsx)("button",{type:"button",onClick:s,className:"text-sm font-semibold text-neutral-400 transition hover:text-white",children:"Close"})]})]}),(0,n.jsxs)("div",{className:"grid gap-4 md:grid-cols-[220px,1fr]",children:[(0,n.jsx)("aside",{className:"h-72 overflow-y-auto rounded-lg border border-neutral-800 bg-neutral-900/40",children:0===r.length?(0,n.jsx)("p",{className:"px-4 py-6 text-xs text-neutral-500",children:"Inbox is empty."}):(0,n.jsx)("ul",{className:"divide-y divide-neutral-800 text-xs",children:r.map(e=>(0,n.jsxs)("li",{onClick:()=>m(e.SMSID),className:"cursor-pointer px-4 py-3 transition hover:bg-neutral-800/60 ".concat(e.SMSID===(null==b?void 0:b.SMSID)?"bg-neutral-800/80":""),children:[(0,n.jsx)("p",{className:"font-semibold ".concat(e.SMSUnread?"text-white":"text-neutral-300"),children:e.SMSSender||"Unknown sender"}),(0,n.jsx)("p",{className:"mt-1 line-clamp-2 text-[11px] text-neutral-500",children:e.SMSContent||"(empty message)"}),(0,n.jsx)("p",{className:"mt-2 text-[10px] uppercase tracking-wide text-neutral-600",children:(0,o.F1)(e.SMSDateTime)})]},e.SMSID))})}),(0,n.jsx)("section",{className:"flex h-72 flex-col rounded-lg border border-neutral-800 bg-neutral-900/40 p-4",children:b?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-start justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-sm font-semibold text-white",children:b.SMSSender||"Unknown sender"}),(0,n.jsx)("p",{className:"text-xs text-neutral-500",children:(0,o.F1)(b.SMSDateTime)})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{type:"button",onClick:()=>c(b,!b.SMSUnread),disabled:i,className:"rounded-lg border border-neutral-700 px-3 py-1 text-xs font-semibold text-neutral-200 transition hover:border-neutral-500 hover:text-white disabled:cursor-not-allowed disabled:opacity-60",children:b.SMSUnread?"Mark as read":"Mark as unread"}),(0,n.jsx)("button",{type:"button",onClick:()=>u(b.SMSID),disabled:i,className:"rounded-lg border border-red-600/60 px-3 py-1 text-xs font-semibold text-red-300 transition hover:border-red-500 hover:text-red-200 disabled:cursor-not-allowed disabled:opacity-60",children:"Delete"})]})]}),(0,n.jsx)("div",{className:"mt-4 flex-1 overflow-y-auto rounded-lg bg-neutral-950/60 p-4 text-sm text-neutral-200",children:(0,n.jsx)("p",{className:"whitespace-pre-wrap",children:b.SMSContent||"(empty message)"})})]}):(0,n.jsx)("p",{className:"text-sm text-neutral-500",children:"Select a message on the left to read its contents."})})]})]})})}function C(e){var t;let{open:l,onClose:a,draft:s,onChange:r,onSubmit:i,saving:o}=e;return l&&s?(0,n.jsx)("div",{className:"fixed inset-0 z-[1150] flex items-center justify-center bg-black/70 px-4 py-8",children:(0,n.jsxs)("div",{className:"w-full max-w-xl rounded-xl border border-neutral-800 bg-neutral-950 p-6 shadow-2xl",children:[(0,n.jsxs)("header",{className:"mb-4 flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Edit Configuration"}),(0,n.jsx)("p",{className:"text-xs text-neutral-500",children:"Update router credentials, listener address, and polling interval."})]}),(0,n.jsx)("button",{type:"button",onClick:a,className:"text-sm font-semibold text-neutral-400 transition hover:text-white",children:"Close"})]}),(0,n.jsxs)("form",{className:"grid gap-4 text-sm",onSubmit:i,children:[(0,n.jsxs)("label",{className:"flex flex-col gap-1 text-neutral-500",children:[(0,n.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Router Host"}),(0,n.jsx)("input",{value:s.router_host,onChange:e=>r("router_host",e.target.value),required:!0,className:"rounded-md border border-neutral-700 bg-neutral-900/70 px-3 py-2 text-neutral-200 outline-none transition focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]}),(0,n.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,n.jsxs)("label",{className:"flex flex-col gap-1 text-neutral-500",children:[(0,n.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Router User"}),(0,n.jsx)("input",{value:s.router_user,onChange:e=>r("router_user",e.target.value),className:"rounded-md border border-neutral-700 bg-neutral-900/70 px-3 py-2 text-neutral-200 outline-none transition focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]}),(0,n.jsxs)("label",{className:"flex flex-col gap-1 text-neutral-500",children:[(0,n.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Router Password"}),(0,n.jsx)("input",{type:"password",value:s.router_password,onChange:e=>r("router_password",e.target.value),className:"rounded-md border border-neutral-700 bg-neutral-900/70 px-3 py-2 text-neutral-200 outline-none transition focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]})]}),(0,n.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,n.jsxs)("label",{className:"flex flex-col gap-1 text-neutral-500",children:[(0,n.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Listen Host"}),(0,n.jsx)("input",{value:s.listen_host,onChange:e=>r("listen_host",e.target.value),required:!0,className:"rounded-md border border-neutral-700 bg-neutral-900/70 px-3 py-2 text-neutral-200 outline-none transition focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]}),(0,n.jsxs)("label",{className:"flex flex-col gap-1 text-neutral-500",children:[(0,n.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Listen Port"}),(0,n.jsx)("input",{value:s.listen_port,onChange:e=>r("listen_port",e.target.value),required:!0,className:"rounded-md border border-neutral-700 bg-neutral-900/70 px-3 py-2 text-neutral-200 outline-none transition focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]})]}),(0,n.jsxs)("label",{className:"flex flex-col gap-1 text-neutral-500",children:[(0,n.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Poll interval (ms)"}),(0,n.jsx)("input",{value:null!==(t=s.poll_interval_ms)&&void 0!==t?t:"",onChange:e=>r("poll_interval_ms",e.target.value),className:"rounded-md border border-neutral-700 bg-neutral-900/70 px-3 py-2 text-neutral-200 outline-none transition focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]}),(0,n.jsx)("div",{className:"flex justify-end",children:(0,n.jsx)("button",{type:"submit",disabled:o,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-blue-500 disabled:cursor-not-allowed disabled:bg-blue-600/50",children:o?"Saving…":"Save changes"})})]})]})}):null}function D(e){var t,l,a,s,r,i,d,c,u,x,m,b,p,h,v,g,f,j,N,w,y,S,_;let{open:C,onClose:D,preloginStatus:M,wanStatus:I}=e;if(!C)return null;let E=null!==(x=null==M?void 0:null===(a=M.wan_conns)||void 0===a?void 0:null===(l=a[0])||void 0===l?void 0:null===(t=l.ipConns)||void 0===t?void 0:t[0])&&void 0!==x?x:{},R=null!==(m=null==M?void 0:null===(s=M.root_info)||void 0===s?void 0:s[0])&&void 0!==m?m:{},A=null!==(b=null==I?void 0:null===(d=I.wan_conns)||void 0===d?void 0:null===(i=d[0])||void 0===i?void 0:null===(r=i.ipConns)||void 0===r?void 0:r[0])&&void 0!==b?b:{},U=null!==(h=null!==(p=A.DefaultGateway)&&void 0!==p?p:E.DefaultGateway)&&void 0!==h?h:"—";(0,o.SR)(M);let P=null!==(g=null!==(v=A.X_CT_COM_IPv6IPAddress)&&void 0!==v?v:E.X_CT_COM_IPv6IPAddress)&&void 0!==g?g:"—",T=(E.DNSServers||"").split(/[ ,\n]+/).map(e=>e.trim()).filter(Boolean),L=null!==(j=null!==(f=null==R?void 0:R.RootMacAddress)&&void 0!==f?f:null==R?void 0:R.RootMacAddress)&&void 0!==j?j:"—",B=null!==(N=null==M?void 0:null===(u=M.device_cfg)||void 0===u?void 0:null===(c=u[0])||void 0===c?void 0:c.X_ALU_COM_LastActiveTime)&&void 0!==N?N:null,O=(0,o._o)(B),F="string"==typeof B&&""!==B.trim()&&"—"!==O&&O!==B?"".concat(O," • ").concat(B):O;return(0,n.jsx)("div",{className:"fixed inset-0 z-[1150] flex items-center justify-center bg-black/70 px-4 py-8",children:(0,n.jsxs)("div",{className:"w-full max-w-3xl rounded-xl border border-neutral-800 bg-neutral-950 p-6 shadow-2xl",children:[(0,n.jsxs)("header",{className:"mb-4 flex items-center justify-between",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-white",children:"WAN Connection Details"}),(0,n.jsx)("button",{type:"button",onClick:D,className:"text-sm font-semibold text-neutral-400 transition hover:text-white",children:"Close"})]}),(0,n.jsxs)("div",{className:"grid gap-4 text-sm text-neutral-200 md:grid-cols-2",children:[(0,n.jsx)(k,{label:"Connection",value:null!==(w=E.Name)&&void 0!==w?w:"—"}),(0,n.jsx)(k,{label:"Status",value:null!==(S=null!==(y=A.ConnectionStatus)&&void 0!==y?y:E.ConnectionStatus)&&void 0!==S?S:"Unknown"}),(0,n.jsx)(k,{label:"External IPv4",value:null!==(_=(0,o.SR)(M))&&void 0!==_?_:"—"}),(0,n.jsx)(k,{label:"External IPv6",value:null!=P?P:"—"}),(0,n.jsx)(k,{label:"Gateway",value:null!=U?U:"—"}),(0,n.jsx)(k,{label:"DNS Servers",value:T.length>0?T.join(", "):"Not provided"}),(0,n.jsx)(k,{label:"MAC Address",value:L}),(0,n.jsx)(k,{label:"Session Length",value:F})]})]})})}function k(e){let{label:t,value:l}=e;return(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-neutral-500",children:t}),(0,n.jsx)("span",{className:"text-sm text-neutral-200",children:l})]})}var M=l(8775),I=l(8595);let E=null!==(a=l(357).env.NEXT_PUBLIC_API_BASE_URL)&&void 0!==a?a:"";async function R(e){let t=await fetch("".concat(E).concat(e),{cache:"no-store"});if(!t.ok)throw Error("Request to ".concat(e," failed with ").concat(t.status));return await t.json()}function A(){var e,t,l;let[a,i]=(0,r.useState)({}),[d,c]=(0,r.useState)(!0),[m,b]=(0,r.useState)(null),[p,h]=(0,r.useState)(1e3),[v,g]=(0,r.useState)(null),[f,j]=(0,r.useState)(!1),[N,w]=(0,r.useState)(0),[y,k]=(0,r.useState)(null),[A,T]=(0,r.useState)(!1),[L,B]=(0,r.useState)(!1),[O,F]=(0,r.useState)(null),[W,G]=(0,r.useState)(!1),[X,z]=(0,r.useState)(null),[q,H]=(0,r.useState)(!1),[V,Q]=(0,r.useState)(null),[$,J]=(0,r.useState)(!1),[Y,K]=(0,r.useState)(!1),[Z,ee]=(0,r.useState)(""),[et,el]=(0,r.useState)(!1),[ea,en]=(0,r.useState)(!1),[es,er]=(0,r.useState)(!1),ei=(0,r.useCallback)(e=>{k(e)},[]),eo=(0,r.useCallback)(async e=>{if(!q){H(!0);try{let t=await fetch("".concat(E,"/api/led_state"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enable:e})});if(!t.ok)throw Error("LED update failed (".concat(t.status,")"));z(e),i(t=>({...t,ledState:e})),ei({tone:"success",message:e?"Device LEDs enabled.":"Device LEDs disabled."})}catch(e){ei({tone:"error",message:e.message||"Unable to change LED state."})}finally{H(!1)}}},[q,ei]),ed=(0,r.useCallback)(async()=>{if(!et){el(!0),ei({tone:"info",message:"Renewing WAN IP…"});try{let e=(0,o.SR)(a.preloginStatus);await U("/api/set_apn?apn=internet"),await P(1e3),await U("/api/set_apn?apn=xlunlimited"),await P(1e3);let t=null,l=a.preloginStatus;for(let a=0;a<30&&(l=await R("/api/prelogin_status"),!(t=(0,o.SR)(l))||t===e);a+=1)await P(1e3);t&&t!==e?(ei({tone:"success",message:"New WAN IP acquired: ".concat(t)}),i(e=>({...e,preloginStatus:l}))):ei({tone:"error",message:"Unable to obtain a new WAN IP. Please try again later."})}catch(e){ei({tone:"error",message:e.message||"WAN IP renewal failed."})}finally{el(!1),w(Date.now())}}},[a.preloginStatus,et,ei]),ec=(0,r.useCallback)(async()=>{if(!ea){en(!0),ei({tone:"info",message:"Sending reboot command…"});try{await R("/api/do_reboot"),ei({tone:"success",message:"Reboot command sent. Router is restarting."})}catch(e){ei({tone:"error",message:e.message||"Unable to reboot the device."})}finally{en(!1)}}},[ea,ei]),eu=(0,r.useCallback)(async e=>{if(!es){er(!0);try{var t;let l=Math.max(Date.now(),(null!==(t=a.dataExpired)&&void 0!==t?t:0)*1e3),n=Math.floor((l+1e3*e)/1e3);await U("/api/set_data_expired?data_expired=".concat(n)),i(e=>({...e,dataExpired:n})),ei({tone:"success",message:"Data expiration updated."})}catch(e){ei({tone:"error",message:e.message||"Failed to update data expiration."})}finally{er(!1)}}},[a.dataExpired,es,ei]),ex=(0,r.useCallback)(async e=>{if(e.preventDefault(),es)return;if(!Z){ei({tone:"error",message:"Please pick a date first."});return}let t=new Date("".concat(Z,"T00:00:00"));if(Number.isNaN(t.getTime())){ei({tone:"error",message:"Invalid date format."});return}er(!0);try{let e=Math.floor(t.getTime()/1e3);await U("/api/set_data_expired?data_expired=".concat(e)),i(t=>({...t,dataExpired:e})),ee(""),ei({tone:"success",message:"Expiration date saved."})}catch(e){ei({tone:"error",message:e.message||"Failed to save expiration date."})}finally{er(!1)}},[Z,es,ei]),em=(0,r.useCallback)(async()=>{if(!$){J(!0);try{let e=await R("/api/sms");i(t=>({...t,sms:(0,o.EE)(e)}))}catch(e){ei({tone:"error",message:e.message||"Unable to refresh SMS inbox."})}finally{J(!1)}}},[$,ei]),eb=(0,r.useCallback)(async(e,t)=>{if(!$){J(!0);try{let l="/api/set_sms_state?smsid=".concat(encodeURIComponent(e.SMSID),"&smsunread=").concat(t?1:0);await R(l),i(l=>{var a;return{...l,sms:null===(a=l.sms)||void 0===a?void 0:a.map(l=>l.SMSID===e.SMSID?{...l,SMSUnread:t}:l)}})}catch(e){ei({tone:"error",message:e.message||"Unable to update SMS state."})}finally{J(!1)}}},[$,ei]),ep=(0,r.useCallback)(async e=>{if(!$){J(!0);try{let t=await fetch("".concat(E,"/api/delete_sms"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sms_ids:[e]})});if(!t.ok)throw Error("Failed to delete SMS (".concat(t.status,")"));i(t=>{var l;return{...t,sms:null===(l=t.sms)||void 0===l?void 0:l.filter(t=>t.SMSID!==e)}}),Q(t=>t===e?null:t),ei({tone:"success",message:"SMS deleted."})}catch(e){ei({tone:"error",message:e.message||"Unable to delete SMS."})}finally{J(!1)}}},[$,ei]),eh=(0,r.useCallback)(()=>{a.config&&F((0,o.SD)(a.config,1e3)),T(!0)},[a.config]),ev=(0,r.useCallback)((e,t)=>{F(l=>l?{...l,[e]:t}:l)},[]),eg=(0,r.useCallback)(async e=>{if(e.preventDefault(),O&&!W){G(!0);try{await R("/api/config/listener_available?host=".concat(encodeURIComponent(O.listen_host),"&port=").concat(encodeURIComponent(O.listen_port)));let e={router_host:O.router_host,router_user:O.router_user,router_password:O.router_password,listen_host:O.listen_host,listen_port:O.listen_port,poll_interval_ms:(()=>{let e=Number(O.poll_interval_ms);return Number.isFinite(e)&&e>0?Math.max(500,e):1e3})()},t=await fetch("".concat(E,"/api/config"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error((null==e?void 0:e.error)||"Config save failed (".concat(t.status,")"))}ei({tone:"success",message:"Configuration saved."}),T(!1),w(Date.now())}catch(e){ei({tone:"error",message:e.message||"Unable to save configuration."})}finally{G(!1)}}},[O,W,ei]);(0,r.useEffect)(()=>{let e,t=!0,l=async()=>{try{j(!0);let[e,l,a,n,s,r,d,c,u,x,m,p,v]=await Promise.all([R("/api/config"),R("/api/prelogin_status"),R("/api/status_web"),R("/api/service_data"),R("/api/cell_identification").catch(()=>null),R("/api/device_status"),R("/api/daily_usage"),R("/api/get_data_expired").catch(()=>null),R("/api/sms").catch(()=>null),R("/api/wlan_configs_24g").catch(()=>null),R("/api/wlan_configs_5g").catch(()=>null),R("/api/wan_status").catch(()=>null),R("/api/led_state").catch(()=>null)]);if(!t)return;let f=null!=e?e:{};i({config:f,preloginStatus:l,statusWeb:a,serviceData:n,cellIdentification:s,deviceStatus:r,dailyUsage:d,dataExpired:(0,o.GQ)(c),sms:(0,o.EE)(u),wlan24:x,wlan5:m,wanStatus:p,ledState:(0,o.Av)(v)}),z((0,o.Av)(v)),g(Date.now()),b(null);let N=Math.max(500,(0,o.Rg)(f,1e3));h(e=>e===N?e:N)}catch(e){var a;if(!t)return;b(null!==(a=e.message)&&void 0!==a?a:"Unable to load dashboard data.")}finally{if(!t)return;c(!1),j(!1),e=setTimeout(l,p)}};return l(),()=>{t=!1,clearTimeout(e)}},[p,N]),(0,r.useEffect)(()=>{if(!y)return;let e=setTimeout(()=>k(null),4e3);return()=>clearTimeout(e)},[y]),(0,r.useEffect)(()=>{var e;if(!L)return;let t=null!==(e=a.sms)&&void 0!==e?e:[];if(0===t.length){Q(null);return}Q(e=>e&&t.some(t=>t.SMSID===e)?e:t[0].SMSID)},[a.sms,L]);let ef=()=>{w(Date.now())},ej=(0,r.useMemo)(()=>Math.round(p/1e3),[p]),eN=null!==(t=null===(e=a.sms)||void 0===e?void 0:e.filter(e=>e.SMSUnread).length)&&void 0!==t?t:0;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S,{toast:y,onDismiss:()=>k(null)}),(0,n.jsxs)(M.V,{children:[(0,n.jsxs)("section",{className:"space-y-4",children:[(0,n.jsx)(I.m,{eyebrow:"Nokia FastMile 5G Gateway 2",title:"Modem Dashboard",description:(0,n.jsxs)(n.Fragment,{children:["Live signal metrics, traffic usage, device health, and connected clients. Data refreshes automatically every ",ej," second",1===ej?"":"s"," (configurable via backend settings)."]}),actions:(0,n.jsxs)("div",{className:"flex items-center gap-2 rounded-xl border border-neutral-800 bg-neutral-900/60 p-2",children:[(0,n.jsx)(u,{ariaLabel:"Refresh",onClick:ef,disabled:f,children:f?"↻…":"↻"}),(0,n.jsxs)(u,{ariaLabel:"SMS Inbox",onClick:()=>B(!0),children:["\uD83D\uDCE8",eN>0&&(0,n.jsx)("span",{className:"absolute -top-1 -right-1 rounded-full bg-red-500 px-1.5 text-[10px] font-semibold text-white",children:eN})]}),(0,n.jsx)(u,{ariaLabel:"Configuration",onClick:eh,children:"⚙"})]})}),(0,n.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,n.jsx)("button",{type:"button",onClick:ef,className:"inline-flex items-center gap-2 rounded-lg border border-blue-500/50 bg-blue-600/10 px-4 py-2 text-sm font-semibold text-blue-300 transition hover:bg-blue-600/20",children:f?(0,n.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,n.jsx)("span",{className:"h-2 w-2 animate-ping rounded-full bg-blue-300"}),"Refreshing…"]}):"Refresh now"}),(0,n.jsx)(s.default,{href:"/report",className:"inline-flex items-center gap-2 rounded-lg border border-neutral-700 px-4 py-2 text-sm font-semibold text-neutral-200 transition hover:border-neutral-500 hover:text-white",children:"Detailed usage report"})]})]}),m&&(0,n.jsx)("div",{className:"rounded-lg border border-red-500/60 bg-red-500/10 px-4 py-3 text-sm text-red-200",children:m}),d?(0,n.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((e,t)=>(0,n.jsx)("div",{className:"h-48 animate-pulse rounded-xl border border-neutral-800 bg-neutral-900/60"},t))}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x,{data:a,ledEnabled:X,ledBusy:q,onToggleLed:eo,onRenewIp:ed,renewing:et,onReboot:ec,rebooting:ea,onOpenWanDetails:()=>K(!0),onExtendData:eu,onCustomExpirySubmit:ex,onCustomExpiryChange:e=>ee(e),customExpiry:Z,expiryBusy:es}),(0,n.jsxs)("footer",{className:"flex flex-col gap-1 text-xs text-neutral-500 md:flex-row md:items-center md:justify-between",children:[(0,n.jsxs)("span",{children:["Last updated:"," ",v?new Date(v).toLocaleString():"—"]}),(0,n.jsxs)("span",{children:["Poll interval: ",ej," second",1===ej?"":"s"]})]})]})]}),(0,n.jsx)(_,{open:L,onClose:()=>B(!1),messages:null!==(l=a.sms)&&void 0!==l?l:[],busy:$,onRefresh:em,onMarkRead:eb,onDelete:ep,selectedSmsId:V,onSelect:Q}),(0,n.jsx)(C,{open:A,onClose:()=>T(!1),draft:O,onChange:ev,onSubmit:eg,saving:W}),(0,n.jsx)(D,{open:Y,onClose:()=>K(!1),preloginStatus:a.preloginStatus,wanStatus:a.wanStatus})]})}async function U(e){let t=await fetch("".concat(E).concat(e));if(!t.ok)throw Error("Request to ".concat(e," failed with ").concat(t.status));await t.json().catch(()=>null)}async function P(e){return new Promise(t=>setTimeout(t,e))}}},function(e){e.O(0,[528,502,762,971,23,744],function(){return e(e.s=7162)}),_N_E=e.O()}]);