(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7162:function(e,t,a){Promise.resolve().then(a.bind(a,8795))},8795:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ex}});var l,s=a(7437),n=a(3274),r=a(6706),i=a(4086),d=a(4258),o=a(2265),c=a(7776),u=a(2447),m=a(338),x=a(2483),p=a(8002),g=a(7138),h=a(7104),f=a(4693),v=a(495),b=a(6013),j=a(7440);let y=o.forwardRef((e,t)=>{let{className:a,type:l="text",...n}=e;return(0,s.jsx)("input",{type:l,className:(0,j.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...n})});y.displayName="Input";var N=a(571),w=a(9646);let S=o.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(w.fC,{className:(0,j.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...l,ref:t,children:(0,s.jsx)(w.bU,{className:(0,j.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})});S.displayName=w.fC.displayName;var C=a(781);function _(e){let{delayDuration:t=0,...a}=e;return(0,s.jsx)(C.zt,{"data-slot":"tooltip-provider",delayDuration:t,...a})}function k(e){let{...t}=e;return(0,s.jsx)(_,{children:(0,s.jsx)(C.fC,{"data-slot":"tooltip",...t})})}function D(e){let{...t}=e;return(0,s.jsx)(C.xz,{"data-slot":"tooltip-trigger",...t})}function M(e){let{className:t,sideOffset:a=0,children:l,...n}=e;return(0,s.jsx)(C.h_,{children:(0,s.jsxs)(C.VY,{"data-slot":"tooltip-content",sideOffset:a,className:(0,j.cn)("bg-foreground text-background animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",t),...n,children:[l,(0,s.jsx)(C.Eh,{className:"bg-foreground fill-foreground z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}function B(e){let{title:t,description:a,action:l,children:n}=e;return(0,s.jsxs)(b.Zb,{className:"border-border/70 bg-card/80 text-card-foreground",children:[(0,s.jsxs)(b.Ol,{className:"flex flex-row items-start justify-between gap-4 pb-4",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(b.ll,{className:"text-base font-semibold leading-none text-foreground",children:t}),a?(0,s.jsx)(b.SZ,{className:"text-xs text-muted-foreground",children:a}):null]}),l?(0,s.jsx)("div",{className:"flex items-center gap-2",children:l}):null]}),(0,s.jsx)(b.aY,{className:"space-y-4 text-sm text-muted-foreground",children:n})]})}function T(e){let{data:t,ledEnabled:a,ledBusy:l,onToggleLed:n,onRenewIp:r,renewing:i,onReboot:d,rebooting:o,onOpenWanDetails:c,onExtendData:u,onCustomExpirySubmit:m,onCustomExpiryChange:x,customExpiry:p,expiryBusy:g}=e;return(0,s.jsxs)("div",{className:"grid gap-6 xl:grid-cols-[1.2fr,1fr]",children:[(0,s.jsxs)("section",{className:"grid gap-6",children:[(0,s.jsx)(I,{statusWeb:t.statusWeb,serviceData:t.serviceData,cellIdentification:t.cellIdentification,wanStatus:t.wanStatus,preloginStatus:t.preloginStatus,onOpenWanDetails:c}),(0,s.jsx)(A,{dailyUsage:t.dailyUsage}),(0,s.jsx)(F,{dataExpired:t.dataExpired,onExtendThirtyDays:()=>u(2592e3),onSubmit:m,onDateChange:x,dateValue:p,busy:g})]}),(0,s.jsxs)("section",{className:"grid gap-6",children:[(0,s.jsx)(P,{ledEnabled:a,ledBusy:l,onToggleLed:n,onRenewIp:r,renewing:i,onReboot:d,rebooting:o,onOpenWanDetails:c}),(0,s.jsx)(E,{deviceStatus:t.deviceStatus}),(0,s.jsx)(L,{wlan24:t.wlan24,wlan5:t.wlan5}),(0,s.jsx)(O,{preloginStatus:t.preloginStatus})]})]})}function I(e){var t,a,l,n,r,i,d,c,m,x,p,g,f,b,j,y,w,S,C,_,k,D,M,T,I,E,R,U,A,P;let{statusWeb:L,serviceData:O,cellIdentification:F,wanStatus:W,preloginStatus:Z,onOpenWanDetails:H}=e,G=null!==(f=null==L?void 0:null===(a=L.cell_LTE_stats_cfg)||void 0===a?void 0:null===(t=a[0])||void 0===t?void 0:t.stat)&&void 0!==f?f:{},X=[{label:"Band",value:G.Band},{label:"PCI",value:G.PhysicalCellID},{label:"EARFCN",value:G.DownlinkEarfcn},{label:"ECI",value:G.ECI}],Y=[{label:"RSRP",value:(0,h.$2)(G.RSRPCurrent,"dBm"),percent:(0,h.gb)(G.RSRPCurrent,-140,-64)},{label:"RSRQ",value:(0,h.$2)(G.RSRQCurrent,"dB"),percent:(0,h.gb)(G.RSRQCurrent,-20,-3)},{label:"SNR",value:(0,h.$2)(G.SNRCurrent,"dB"),percent:(0,h.gb)(G.SNRCurrent,-10,30)},{label:"RSSI",value:(0,h.$2)(G.RSSICurrent,"dBm"),percent:(0,h.gb)(G.RSSICurrent,-120,-30)}],{downlink:q,uplink:Q}=(0,o.useMemo)(()=>{var e;let t=e=>Array.isArray(e)?e:e&&"object"==typeof e?Object.values(e):[],a=null!==(e=null==O?void 0:O.FunctionResult)&&void 0!==e?e:{};return{downlink:t(null==a?void 0:a.LTEDLCA),uplink:t(null==a?void 0:a.LTEULCA)}},[O]),$=(null!==(b=null==q?void 0:q.length)&&void 0!==b?b:0)>0||(null!==(j=null==Q?void 0:Q.length)&&void 0!==j?j:0)>0,J=null!==(S=null!==(w=null!==(y=null==F?void 0:null===(l=F.FunctionResult)||void 0===l?void 0:l.Name)&&void 0!==y?y:null==F?void 0:F.Name)&&void 0!==w?w:null==F?void 0:null===(n=F.functionResult)||void 0===n?void 0:n.Name)&&void 0!==S?S:null,K=null!==(C=null==Z?void 0:null===(d=Z.wan_conns)||void 0===d?void 0:null===(i=d[0])||void 0===i?void 0:null===(r=i.ipConns)||void 0===r?void 0:r[0])&&void 0!==C?C:{},ee=null!==(_=null==W?void 0:null===(x=W.wan_conns)||void 0===x?void 0:null===(m=x[0])||void 0===m?void 0:null===(c=m.ipConns)||void 0===c?void 0:c[0])&&void 0!==_?_:{},et=null!==(k=(0,h.SR)(Z))&&void 0!==k?k:"—",ea=null!==(M=null!==(D=ee.X_CT_COM_IPv6IPAddress)&&void 0!==D?D:K.X_CT_COM_IPv6IPAddress)&&void 0!==M?M:"—",el=null!==(T=null==K?void 0:K.DNSServers)&&void 0!==T?T:"—",es=null!==(I=null==K?void 0:K.X_CT_COM_IPv6DNSServers)&&void 0!==I?I:"—",en=null!==(R=null!==(E=ee.DefaultGateway)&&void 0!==E?E:K.DefaultGateway)&&void 0!==R?R:"—",er=null!==(A=null!==(U=ee.ConnectionStatus)&&void 0!==U?U:K.ConnectionStatus)&&void 0!==A?A:"Unknown",ei=null!==(P=null==Z?void 0:null===(g=Z.device_cfg)||void 0===g?void 0:null===(p=g[0])||void 0===p?void 0:p.X_ALU_COM_LastActiveTime)&&void 0!==P?P:null,ed=(0,h._o)(ei),eo="string"==typeof ei&&""!==ei.trim()&&"—"!==ed&&ed!==ei?"".concat(ed," • ").concat(ei):ed;return(0,s.jsxs)(B,{title:null!=J?J:"LTE Signal",description:"Signal quality, carrier aggregation, and WAN connection summary",action:(0,s.jsx)(v.z,{variant:"link",size:"sm",onClick:H,className:"px-0",children:"View details"}),children:[(0,s.jsxs)(u.fC,{defaultValue:"signal",className:"space-y-3",children:[(0,s.jsxs)(u.aV,{className:"inline-flex w-full items-center gap-1 rounded-lg border border-neutral-800 bg-neutral-900/60 p-0.5 text-xs font-semibold uppercase tracking-wide",children:[(0,s.jsx)(u.xz,{value:"signal",className:"flex-1 rounded-md px-3 py-1 text-neutral-400 transition hover:text-white data-[state=active]:bg-neutral-800 data-[state=active]:text-white",children:"Signal"}),(0,s.jsx)(u.xz,{value:"ca",className:"flex-1 rounded-md px-3 py-1 text-neutral-400 transition hover:text-white data-[state=active]:bg-neutral-800 data-[state=active]:text-white",children:"Carrier Agg."})]}),(0,s.jsxs)(u.VY,{value:"signal",className:"space-y-3",children:[(0,s.jsx)("div",{className:"grid grid-cols-1 gap-2 text-sm text-neutral-400",children:(0,s.jsx)("span",{className:"font-semibold text-neutral-500",children:"Main Signal"})}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2 text-xs text-neutral-400",children:X.map(e=>{let{label:t,value:a}=e;return(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("span",{className:"font-semibold text-neutral-500",children:t}),(0,s.jsx)("span",{className:"text-sm text-neutral-200",children:null!=a?a:"—"})]},t)})}),(0,s.jsx)("hr",{className:"border-neutral-800"}),(0,s.jsx)("div",{className:"space-y-3 text-xs text-neutral-400",children:Y.map(e=>{let{label:t,value:a,percent:l}=e;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"mb-1.5 flex items-center justify-between",children:[(0,s.jsx)("span",{className:"font-semibold text-neutral-500",children:t}),(0,s.jsx)("span",{className:"text-sm text-neutral-200",children:a})]}),(0,s.jsx)(N.E,{value:l,className:"h-1.5 bg-neutral-800"})]},t)})})]}),(0,s.jsx)(u.VY,{value:"ca",className:"space-y-3",children:$?(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsx)(z,{title:"Downlink",carriers:q}),(0,s.jsx)(z,{title:"Uplink",carriers:Q})]}):(0,s.jsx)("p",{className:"text-xs text-neutral-500",children:"Carrier aggregation data is not available."})})]}),(0,s.jsx)("div",{className:"space-y-3 text-xs text-muted-foreground",children:(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(V,{label:"External IPv4",value:et}),(0,s.jsx)(V,{label:"External IPv6",value:ea}),(0,s.jsx)(V,{label:"Gateway",value:en}),(0,s.jsx)(V,{label:"DNSv4",value:el}),(0,s.jsx)(V,{label:"DNSv6",value:es}),(0,s.jsx)(V,{label:"Status",value:er}),(0,s.jsx)(V,{label:"Session",value:eo})]})})]})}function E(e){var t,a,l,n,r,i,d;let{deviceStatus:o}=e,c=null!==(n=null==o?void 0:o.UpTime)&&void 0!==n?n:0,u=null!==(r=null==o?void 0:null===(t=o.cpu_usageinfo)||void 0===t?void 0:t.CPUUsage)&&void 0!==r?r:null,m=null!==(i=null==o?void 0:null===(a=o.mem_info)||void 0===a?void 0:a.Total)&&void 0!==i?i:0,x=null!==(d=null==o?void 0:null===(l=o.mem_info)||void 0===l?void 0:l.Free)&&void 0!==d?d:0,p=m>0?Math.round((m-x)/m*100):0;return(0,s.jsx)(B,{title:"Device Health",description:"Runtime statistics reported by the modem",children:(0,s.jsxs)("div",{className:"grid gap-3",children:[(0,s.jsx)(V,{label:"Uptime",value:(0,h.d5)(c)}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,s.jsx)("span",{className:"font-semibold text-muted-foreground",children:"CPU Usage"}),(0,s.jsxs)(f.C,{variant:"outline",className:"font-semibold",children:[u,"%"]})]}),(0,s.jsx)(N.E,{value:u,className:"h-2"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,s.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Memory Usage"}),(0,s.jsxs)(f.C,{variant:"outline",className:"font-semibold",children:[p,"%"]})]}),(0,s.jsx)(N.E,{value:p,className:"h-2"})]})]})})}function R(e){if(0===e.length)return{rows:[],totals:{download:"0 B",upload:"0 B",combined:"0 B"}};let t=e.reduce((e,t)=>e+t.downloadBytes,0),a=e.reduce((e,t)=>e+t.uploadBytes,0),l=e.reduce((e,t)=>e+t.combinedBytes,0);return{rows:e.map((t,a)=>{let s=e[a+1],n=U(t.combinedBytes,null==s?void 0:s.combinedBytes,null==s?void 0:s.label),r=U(t.downloadBytes,null==s?void 0:s.downloadBytes,null==s?void 0:s.label),i=U(t.uploadBytes,null==s?void 0:s.uploadBytes,null==s?void 0:s.label);return{key:t.key,label:t.label,download:(0,h.td)(t.downloadBytes),upload:(0,h.td)(t.uploadBytes),combined:(0,h.td)(t.combinedBytes),share:(0,h.rl)(l>0?t.combinedBytes/l*100:0),downloadBytes:t.downloadBytes,uploadBytes:t.uploadBytes,combinedBytes:t.combinedBytes,previousCombinedBytes:null==s?void 0:s.combinedBytes,downloadTrend:r,uploadTrend:i,trend:n}}),totals:{download:(0,h.td)(t),upload:(0,h.td)(a),combined:(0,h.td)(l)}}}function U(e,t,a){let l,n,r;if(null==t)return null;let i=e-t,d=0===i?"flat":i>0?"up":"down",o=Math.abs(i),c=t>0?o/t*100:null,u="down"===d?"-":"up"===d?"+":"",g="flat"===d?"0":"".concat(u).concat((0,h.td)(o)),f=null===c||"flat"===d?void 0:"".concat(u).concat(c.toFixed(1),"%");"up"===d?(l=(0,s.jsx)(m.Z,{className:"h-3.5 w-3.5 text-emerald-400"}),n="text-emerald-400",r="Naik"):"down"===d?(l=(0,s.jsx)(x.Z,{className:"h-3.5 w-3.5 text-rose-400"}),n="text-rose-400",r="Turun"):(l=(0,s.jsx)(p.Z,{className:"h-3.5 w-3.5 text-muted-foreground"}),n="text-muted-foreground",r="Tidak berubah");let v=null!=a?a:"periode sebelumnya",b="flat"===d?"".concat(r," dibanding ").concat(v):"".concat(r," ").concat((0,h.td)(o)).concat(f?" (".concat(f,")"):""," dibanding ").concat(v);return{icon:l,deltaLabel:g,percentLabel:f,className:n,tooltip:b,previousLabel:v}}function A(e){let{dailyUsage:t}=e,a=(0,o.useMemo)(()=>Array.isArray(null==t?void 0:t.daily_data)?t.daily_data:Array.isArray(null==t?void 0:t.last_7_days)?t.last_7_days:[],[t]),l=(0,o.useMemo)(()=>a.map(e=>{var t,a,l,s,n,r;let i=null==e?void 0:e.date;if(!i)return null;let d=new Date("".concat(i,"T00:00:00Z"));return Number.isNaN(d.getTime())?null:{key:i,date:d,downloadBytes:null!==(s=null==e?void 0:null===(t=e.download)||void 0===t?void 0:t.raw_bytes)&&void 0!==s?s:0,uploadBytes:null!==(n=null==e?void 0:null===(a=e.upload)||void 0===a?void 0:a.raw_bytes)&&void 0!==n?n:0,combinedBytes:null!==(r=null==e?void 0:null===(l=e.combined)||void 0===l?void 0:l.raw_bytes)&&void 0!==r?r:0}}).filter(e=>null!==e).sort((e,t)=>t.date.getTime()-e.date.getTime()),[a]),n=(0,o.useMemo)(()=>l.slice(0,7).map(e=>({key:e.key,label:(0,h.p6)(e.key),sortValue:e.date.getTime(),downloadBytes:e.downloadBytes,uploadBytes:e.uploadBytes,combinedBytes:e.combinedBytes})),[l]),r=(0,o.useMemo)(()=>{let e=new Map;return l.forEach(t=>{let a=function(e){let t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())),a=t.getUTCDay();return t.setUTCDate(t.getUTCDate()-(a+6)%7),t}(t.date),l=new Date(a);l.setUTCDate(l.getUTCDate()+6);let s=a.toISOString().slice(0,10);e.has(s)||e.set(s,{key:s,label:"".concat((0,h.p6)(s)," – ").concat((0,h.p6)(l.toISOString().slice(0,10))),sortValue:a.getTime(),downloadBytes:0,uploadBytes:0,combinedBytes:0});let n=e.get(s);n.downloadBytes+=t.downloadBytes,n.uploadBytes+=t.uploadBytes,n.combinedBytes+=t.combinedBytes}),Array.from(e.values()).sort((e,t)=>t.sortValue-e.sortValue).slice(0,8)},[l]),i=(0,o.useMemo)(()=>{let e=new Map;return l.forEach(t=>{var a;let l=new Date(Date.UTC((a=t.date).getUTCFullYear(),a.getUTCMonth(),1)),s="".concat(l.getUTCFullYear(),"-").concat(String(l.getUTCMonth()+1).padStart(2,"0"));e.has(s)||e.set(s,{key:s,label:l.toLocaleDateString("id-ID",{month:"long",year:"numeric"}),sortValue:l.getTime(),downloadBytes:0,uploadBytes:0,combinedBytes:0});let n=e.get(s);n.downloadBytes+=t.downloadBytes,n.uploadBytes+=t.uploadBytes,n.combinedBytes+=t.combinedBytes}),Array.from(e.values()).sort((e,t)=>t.sortValue-e.sortValue).slice(0,12)},[l]),d=(0,o.useMemo)(()=>R(n),[n]),c=(0,o.useMemo)(()=>R(r),[r]),m=(0,o.useMemo)(()=>R(i),[i]),x=(0,o.useMemo)(()=>{if(l.length<2)return null;let[e,t]=l;return U(e.combinedBytes,t.combinedBytes,(0,h.p6)(t.key))},[l]),p=(0,o.useMemo)(()=>{if(r.length<2)return null;let[e,t]=r;return U(e.combinedBytes,t.combinedBytes,t.label)},[r]),g=(0,o.useMemo)(()=>{if(i.length<2)return null;let[e,t]=i;return U(e.combinedBytes,t.combinedBytes,t.label)},[i]),f=(0,o.useMemo)(()=>[{key:"daily",label:"Harian",dataset:d,emptyMessage:"Belum ada data harian yang terekam."},{key:"weekly",label:"Mingguan",dataset:c,emptyMessage:"Belum ada agregasi mingguan yang tersedia."},{key:"monthly",label:"Bulanan",dataset:m,emptyMessage:"Belum ada agregasi bulanan yang tersedia."}],[d,c,m]);return(0,s.jsx)(B,{title:"Data Usage",description:"Breakdown of modem traffic across daily, weekly, and monthly windows",action:(0,s.jsx)(Z,{href:"/report",children:"Full report"}),children:(0,s.jsxs)(u.fC,{defaultValue:"daily",className:"space-y-4",children:[(0,s.jsx)(u.aV,{className:"inline-flex w-full items-center gap-1 rounded-lg border border-border/70 bg-muted/20 p-0.5 text-xs font-semibold uppercase tracking-wide",children:f.map(e=>(0,s.jsx)(u.xz,{value:e.key,className:"flex-1 rounded-md px-3 py-1 text-muted-foreground transition hover:text-foreground data-[state=active]:bg-muted data-[state=active]:text-foreground",children:e.label},e.key))}),f.map(e=>{let t="daily"===e.key?x:"weekly"===e.key?p:g;return(0,s.jsxs)(u.VY,{value:e.key,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-xs text-muted-foreground",children:[(0,s.jsx)(W,{label:"Download",value:e.dataset.totals.download,tone:"blue",customClass:"text-center"}),(0,s.jsx)(W,{label:"Upload",value:e.dataset.totals.upload,tone:"green",customClass:"text-center"}),(0,s.jsx)(W,{label:"Total",value:e.dataset.totals.combined,tone:"neutral",customClass:"text-center"})]}),t?(0,s.jsxs)("div",{className:"flex gap-1 rounded-lg border border-border/60 bg-muted/30 px-3 py-2 text-xs flex-row items-center justify-between",children:[(0,s.jsxs)(k,{children:[(0,s.jsx)(D,{asChild:!0,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[t.icon,(0,s.jsxs)("span",{className:"font-semibold ".concat(t.className),children:[t.deltaLabel,t.percentLabel?" (".concat(t.percentLabel,")"):""]})]})}),(0,s.jsx)(M,{children:t.tooltip})]}),(0,s.jsxs)("span",{className:"text-muted-foreground",children:["Dibanding ",t.previousLabel]})]}):null,(0,s.jsx)("div",{className:"overflow-hidden rounded-lg border border-border/50",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-border/60 text-xs sm:text-sm",children:[(0,s.jsx)("thead",{className:"bg-muted/50 text-muted-foreground",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left font-semibold",children:"Periode"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right font-semibold",children:"Download"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right font-semibold",children:"Upload"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right font-semibold",children:"Total"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-border/60 text-foreground",children:0===e.dataset.rows.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:5,className:"px-4 py-4 text-center text-xs text-muted-foreground",children:e.emptyMessage})}):e.dataset.rows.map(t=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-4 py-2",children:t.label}),(0,s.jsx)("td",{className:"px-4 py-2 text-right",children:t.downloadTrend?(0,s.jsxs)(k,{children:[(0,s.jsx)(D,{asChild:!0,children:(0,s.jsxs)("span",{className:"inline-flex items-center justify-end gap-1",children:[(0,s.jsx)("span",{className:t.downloadTrend.className,children:t.downloadTrend.icon}),(0,s.jsx)("span",{className:"text-blue-400",children:t.download})]})}),(0,s.jsx)(M,{children:t.downloadTrend.tooltip})]}):(0,s.jsx)("span",{className:"text-blue-400",children:t.download})}),(0,s.jsx)("td",{className:"px-4 py-2 text-right",children:t.uploadTrend?(0,s.jsxs)(k,{children:[(0,s.jsx)(D,{asChild:!0,children:(0,s.jsxs)("span",{className:"inline-flex items-center justify-end gap-1",children:[(0,s.jsx)("span",{className:t.uploadTrend.className,children:t.uploadTrend.icon}),(0,s.jsx)("span",{className:"text-emerald-400",children:t.upload})]})}),(0,s.jsx)(M,{children:t.uploadTrend.tooltip})]}):(0,s.jsx)("span",{className:"text-emerald-400",children:t.upload})}),(0,s.jsx)("td",{className:"px-4 py-2 text-right",children:t.trend?(0,s.jsxs)(k,{children:[(0,s.jsx)(D,{asChild:!0,children:(0,s.jsxs)("span",{className:"inline-flex items-center justify-end gap-1",children:[(0,s.jsx)("span",{className:t.trend.className,children:t.trend.icon}),t.combined]})}),(0,s.jsx)(M,{children:t.trend.tooltip})]}):(0,s.jsx)("span",{className:"inline-flex justify-end",children:t.combined})})]},"".concat(e.key,"-").concat(t.key)))})]})})]},e.key)})]})})}function z(e){let{title:t,carriers:a}=e;return a&&0!==a.length?(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:t}),(0,s.jsx)("ul",{className:"mt-3 space-y-3 text-xs text-muted-foreground",children:a.map((e,a)=>{var l,n,r,i;return(0,s.jsx)("li",{className:"rounded-lg border border-border/60 bg-muted/40 p-3",children:(0,s.jsxs)("div",{className:"grid grid-cols-[1fr,auto] gap-2",children:[(0,s.jsx)("span",{children:"Band"}),(0,s.jsx)("span",{className:"text-foreground",children:null!==(l=e.ScellBand)&&void 0!==l?l:"—"}),(0,s.jsx)("span",{children:"Bandwidth"}),(0,s.jsx)("span",{className:"text-foreground",children:null!==(n=e.ScellBandwidth)&&void 0!==n?n:"—"}),(0,s.jsx)("span",{children:"PCI"}),(0,s.jsx)("span",{className:"text-foreground",children:null!==(r=e.PhysicalCellID)&&void 0!==r?r:"—"}),(0,s.jsx)("span",{children:"EARFCN"}),(0,s.jsx)("span",{className:"text-foreground",children:null!==(i=e.ScellChannel)&&void 0!==i?i:"—"})]})},"".concat(t,"-").concat(a))})})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:t}),(0,s.jsx)("p",{className:"mt-2 text-xs text-muted-foreground",children:"No carriers detected."})]})}function P(e){let{ledEnabled:t,ledBusy:a,onToggleLed:l,onRenewIp:n,renewing:r,onReboot:i,rebooting:d,onOpenWanDetails:o}=e;return(0,s.jsx)(B,{title:"Controls & Actions",description:"Operate modem features and shortcuts",children:(0,s.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-border/60 bg-muted/40 p-4",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-foreground",children:"Device LEDs"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Toggle the enclosure indicators for a quieter environment."})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(f.C,{variant:"outline",className:"text-xs",children:null===t?"Unknown":t?"Enabled":"Disabled"}),(0,s.jsx)(S,{checked:!!t,onCheckedChange:e=>l(e),disabled:a,"aria-label":"Toggle device LEDs"})]})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(v.z,{onClick:n,disabled:r,className:"w-full justify-start",children:r?"Renewing…":"Renew WAN IP"}),(0,s.jsx)(v.z,{onClick:i,disabled:d,variant:"destructive",className:"w-full justify-start",children:d?"Rebooting…":"Reboot modem"}),(0,s.jsx)(v.z,{variant:"outline",onClick:o,className:"w-full justify-start",children:"WAN details"})]})]})})}function L(e){var t,a,l,n,r,i;let{wlan24:d,wlan5:o}=e,c=[{label:"2.4 GHz",config:null!==(n=null==d?void 0:null===(t=d.wlan_config_glb)||void 0===t?void 0:t[0])&&void 0!==n?n:null},{label:"5 GHz",config:null!==(i=null!==(r=null==o?void 0:null===(a=o.wlan_config_glb11ac)||void 0===a?void 0:a[0])&&void 0!==r?r:null==o?void 0:null===(l=o.wlan_config_glb)||void 0===l?void 0:l[0])&&void 0!==i?i:null}];return(0,s.jsx)(B,{title:"Wi-Fi Radios",description:"SSID, channel, and security overview",children:(0,s.jsx)("div",{className:"space-y-3 text-sm text-muted-foreground",children:c.map(e=>{var t,a,l,n;let{label:r,config:i}=e,d=(0,h.sw)(null==i?void 0:i.Enable);return(0,s.jsxs)("div",{className:"rounded-lg border border-border/60 bg-muted/40 px-4 py-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold text-foreground",children:null!==(t=null==i?void 0:i.SSID)&&void 0!==t?t:"—"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:r})]}),(0,s.jsx)(f.C,{variant:d?"secondary":"outline",className:d?"bg-emerald-500/15 text-emerald-400":"text-muted-foreground",children:d?"Enabled":"Disabled"})]}),(0,s.jsxs)("dl",{className:"mt-3 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("dt",{children:"Mode"}),(0,s.jsx)("dd",{className:"text-foreground",children:null!==(a=null==i?void 0:i.X_ALU_COM_Mode)&&void 0!==a?a:"—"})]}),(0,s.jsxs)("div",{className:"ml-auto text-right",children:[(0,s.jsx)("dt",{children:"Channel"}),(0,s.jsx)("dd",{className:"text-foreground",children:null!==(l=null==i?void 0:i.Channel)&&void 0!==l?l:"Auto"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("dt",{children:"Bandwidth"}),(0,s.jsx)("dd",{className:"text-foreground",children:null!==(n=null==i?void 0:i.X_ALU_COM_Bandwidth)&&void 0!==n?n:"—"})]}),(0,s.jsxs)("div",{className:"ml-auto text-right",children:[(0,s.jsx)("dt",{children:"Security"}),(0,s.jsx)("dd",{className:"text-foreground",children:(0,h.FM)(i)})]})]})]},r)})})})}function O(e){let{preloginStatus:t}=e,a=(Array.isArray(null==t?void 0:t.device_cfg)?t.device_cfg:[]).filter(e=>1===e.Active),l=a.filter(e=>"Ethernet"===e.InterfaceType).length,n=a.filter(e=>"Ethernet"!==e.InterfaceType).length,r=a.slice(0,6).map(e=>{var t,a,l;return{id:null!==(l=null!==(a=null!==(t=e.MACAddress)&&void 0!==t?t:e.ID)&&void 0!==a?a:e.HostName)&&void 0!==l?l:Math.random().toString(36),name:e.HostName||e.Alias||"Unknown device",ip:e.IPAddress||"—",iface:e.InterfaceType||"Unknown"}});return(0,s.jsxs)(B,{title:"Connected Devices",description:"Active clients reported by the modem",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-center text-sm text-muted-foreground",children:[(0,s.jsxs)("div",{className:"rounded-lg border border-border/60 bg-muted/40 p-4",children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide",children:"Ethernet"}),(0,s.jsx)("p",{className:"mt-2 text-2xl font-semibold text-foreground",children:l})]}),(0,s.jsxs)("div",{className:"rounded-lg border border-border/60 bg-muted/40 p-4",children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide",children:"Wi-Fi"}),(0,s.jsx)("p",{className:"mt-2 text-2xl font-semibold text-foreground",children:n})]})]}),(0,s.jsx)("div",{className:"mt-4 space-y-2 text-xs",children:0===r.length?(0,s.jsx)("p",{className:"text-muted-foreground",children:"No active clients detected."}):r.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-border/60 bg-muted/40 px-3 py-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold text-foreground",children:e.name}),(0,s.jsx)("p",{className:"text-[11px] text-muted-foreground",children:e.ip})]}),(0,s.jsx)(f.C,{variant:"outline",className:"text-[11px] uppercase",children:e.iface})]},e.id))})]})}function F(e){let{dataExpired:t,onExtendThirtyDays:a,onSubmit:l,onDateChange:n,dateValue:r,busy:i}=e,d=(0,o.useMemo)(()=>{if(!t)return{label:"Not configured",tone:"neutral"};let e=new Date(1e3*t),a=new Date,l=Math.floor((e.getTime()-a.getTime())/864e5);return l<0?{label:"".concat((0,h.p6)(e.toISOString().slice(0,10))," (expired ").concat(Math.abs(l)," day").concat(-1===l?"":"s"," ago)"),tone:"danger"}:l<=3?{label:"".concat((0,h.p6)(e.toISOString().slice(0,10))," (").concat(l," day").concat(1===l?"":"s"," remaining)"),tone:"warning"}:{label:"".concat((0,h.p6)(e.toISOString().slice(0,10))," (").concat(l," day").concat(1===l?"":"s"," remaining)"),tone:"success"}},[t]),c="danger"===d.tone?"text-red-400":"warning"===d.tone?"text-yellow-400":"success"===d.tone?"text-green-400":"text-neutral-300";return(0,s.jsxs)(B,{title:"Data Expiration",description:"Manage how long modem traffic counters remain valid",children:[(0,s.jsx)("p",{className:"text-sm font-semibold ".concat(c),children:d.label}),(0,s.jsxs)("form",{className:"mt-4 space-y-4",onSubmit:l,children:[(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Expiration date"}),(0,s.jsx)(y,{type:"date",value:r,onChange:e=>n(e.target.value),disabled:i})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(v.z,{type:"button",onClick:a,disabled:i,variant:"secondary",className:"w-full",children:"Extend 30 Days"}),(0,s.jsx)(v.z,{type:"submit",disabled:i||!r,className:"w-full",children:"Save Date"})]})]})]})}function V(e){let{label:t,value:a,highlight:l}=e;return(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,s.jsx)("span",{className:"font-semibold",children:t}),(0,s.jsx)("span",{className:l?"text-foreground":"text-muted-foreground",children:a})]})}function W(e){let{label:t,value:a,tone:l,customClass:n}=e;return(0,s.jsxs)("div",{className:"flex h-full flex-col justify-center ".concat(n),children:[(0,s.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-muted-foreground",children:t}),(0,s.jsx)("p",{className:"mt-1 text-base font-semibold ".concat("blue"===l?"text-blue-400":"green"===l?"text-emerald-400":"text-foreground"),children:a})]})}function Z(e){let{href:t,children:a}=e;return(0,s.jsx)(v.z,{asChild:!0,variant:"outline",size:"sm",className:"gap-2",children:(0,s.jsx)(g.default,{href:t,children:a})})}var H=a(7019),G=a(5733),X=a(3304);let Y=X.fC;X.xz;let q=X.h_;X.x8;let Q=o.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(X.aV,{ref:t,className:(0,j.cn)("fixed inset-0 z-50 bg-black/60 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=open]:fade-in-0 data-[state=closed]:fade-out-0",a),...l})});Q.displayName=X.aV.displayName;let $=o.forwardRef((e,t)=>{let{className:a,children:l,...n}=e;return(0,s.jsxs)(q,{children:[(0,s.jsx)(Q,{}),(0,s.jsx)(X.VY,{ref:t,className:(0,j.cn)("fixed left-1/2 top-1/2 z-50 grid w-full max-w-[calc(100vw-3rem)] -translate-x-1/2 -translate-y-1/2 gap-6 rounded-lg border border-border bg-background p-6 shadow-lg duration-200 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-90 data-[state=closed]:zoom-out-95 sm:max-w-3xl sm:p-8",a),...n,children:l})]})});$.displayName=X.VY.displayName;let J=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,j.cn)("flex flex-col space-y-2 text-left",t),...a})};J.displayName="DialogHeader";let K=o.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(X.Dx,{ref:t,className:(0,j.cn)("text-lg font-semibold leading-none tracking-tight",a),...l})});K.displayName=X.Dx.displayName;let ee=o.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(X.dk,{ref:t,className:(0,j.cn)("text-sm text-muted-foreground",a),...l})});ee.displayName=X.dk.displayName;let et=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,j.cn)("space-y-4 text-sm",t),...a})};et.displayName="DialogBody";let ea=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,j.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})};ea.displayName="DialogFooter";var el=a(2286);let es=o.forwardRef((e,t)=>{let{className:a,children:l,...n}=e;return(0,s.jsxs)(el.fC,{ref:t,className:(0,j.cn)("relative overflow-hidden",a),...n,children:[(0,s.jsx)(el.l_,{className:"h-full w-full rounded-[inherit]",children:l}),(0,s.jsx)(en,{}),(0,s.jsx)(el.Ns,{})]})});es.displayName=el.fC.displayName;let en=o.forwardRef((e,t)=>{let{className:a,orientation:l="vertical",...n}=e;return(0,s.jsx)(el.gb,{ref:t,orientation:l,className:(0,j.cn)("flex touch-none select-none transition-colors","vertical"===l&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===l&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...n,children:(0,s.jsx)(el.q4,{className:"relative flex-1 rounded-full bg-border"})})});function er(e){var t,a;let{open:l,onClose:n,messages:r,busy:i,onRefresh:d,onMarkRead:o,onDelete:c,selectedSmsId:u,onSelect:m}=e,x=null!==(a=null!==(t=r.find(e=>e.SMSID===u))&&void 0!==t?t:r[0])&&void 0!==a?a:null;return(0,s.jsx)(Y,{open:l,onOpenChange:e=>{e||n()},children:(0,s.jsxs)($,{children:[(0,s.jsxs)(J,{children:[(0,s.jsx)(K,{children:"SMS Inbox"}),(0,s.jsxs)(ee,{children:[r.length," message",1===r.length?"":"s"," stored on the modem."]})]}),(0,s.jsx)(et,{children:(0,s.jsxs)("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,260px),minmax(0,1fr)] lg:max-h-[70vh]",children:[(0,s.jsx)(es,{className:"min-h-[220px] max-h-[50vh] rounded-md border border-border bg-muted/20 lg:h-[60vh] lg:max-h-none",children:0===r.length?(0,s.jsx)("p",{className:"px-4 py-6 text-sm text-muted-foreground",children:"Inbox is empty."}):(0,s.jsx)("ul",{className:"text-sm",children:r.map(e=>(0,s.jsxs)("li",{onClick:()=>m(e.SMSID),className:"cursor-pointer border-b border-border/60 px-4 py-3 transition hover:bg-muted ".concat(e.SMSID===(null==x?void 0:x.SMSID)?"bg-muted/60":""),children:[(0,s.jsx)("p",{className:"font-semibold ".concat(e.SMSUnread?"text-foreground":"text-muted-foreground"),children:e.SMSSender||"Unknown sender"}),(0,s.jsx)("p",{className:"mt-1 line-clamp-2 text-xs text-muted-foreground",children:e.SMSContent||"(empty message)"}),(0,s.jsx)("p",{className:"mt-2 text-[10px] uppercase tracking-wide text-muted-foreground/80",children:(0,h.F1)(e.SMSDateTime)})]},e.SMSID))})}),(0,s.jsx)("section",{className:"flex min-h-[220px] max-h-[50vh] flex-col gap-4 rounded-md border border-border bg-muted/10 p-4 lg:h-[60vh] lg:max-h-none",children:x?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:x.SMSSender||"Unknown sender"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,h.F1)(x.SMSDateTime)})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.z,{variant:"outline",size:"sm",onClick:()=>o(x,!x.SMSUnread),disabled:i,children:x.SMSUnread?"Mark as read":"Mark as unread"}),(0,s.jsx)(v.z,{variant:"destructive",size:"sm",onClick:()=>c(x.SMSID),disabled:i,children:"Delete"})]})]}),(0,s.jsx)(es,{className:"flex-1 rounded-md border border-border bg-background p-4",children:(0,s.jsx)("p",{className:"whitespace-pre-wrap text-sm text-muted-foreground",children:x.SMSContent||"(empty message)"})})]}):(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Select a message on the left to read its contents."})})]})}),(0,s.jsxs)(ea,{className:"gap-2",children:[(0,s.jsx)(v.z,{variant:"outline",onClick:d,disabled:i,children:"Refresh"}),(0,s.jsx)(v.z,{variant:"ghost",onClick:n,children:"Close"})]})]})})}function ei(e){var t;let{open:a,onClose:l,draft:n,onChange:r,onSubmit:i,saving:d}=e,[c,u]=(0,o.useState)(!1),[m,x]=(0,o.useState)(!1);if(!a||!n)return null;let p="true"===n.telegram_enabled;return(0,s.jsx)(Y,{open:a,onOpenChange:e=>{e||l()},children:(0,s.jsxs)($,{children:[(0,s.jsxs)(J,{children:[(0,s.jsx)(K,{children:"Edit Configuration"}),(0,s.jsx)(ee,{children:"Update modem credentials, listener address, and optional Telegram bridge."})]}),(0,s.jsxs)("form",{className:"space-y-6",onSubmit:i,children:[(0,s.jsxs)(et,{className:"max-h-[65vh] space-y-6 overflow-y-auto pr-1 text-sm",children:[(0,s.jsxs)("div",{className:"grid gap-4",children:[(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Modem Host"}),(0,s.jsx)(y,{value:n.router_host,onChange:e=>r("router_host",e.target.value),required:!0})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Modem User"}),(0,s.jsx)(y,{value:n.router_user,onChange:e=>r("router_user",e.target.value)})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Modem Password"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(y,{type:c?"text":"password",value:n.router_password,onChange:e=>r("router_password",e.target.value),className:"pr-10"}),(0,s.jsx)(v.z,{type:"button",variant:"ghost",size:"icon",onClick:()=>u(e=>!e),className:"absolute right-1.5 top-1/2 -translate-y-1/2","aria-label":c?"Hide password":"Show password",children:c?(0,s.jsx)(H.Z,{className:"h-4 w-4"}):(0,s.jsx)(G.Z,{className:"h-4 w-4"})})]})]})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Listen Host"}),(0,s.jsx)(y,{value:n.listen_host,onChange:e=>r("listen_host",e.target.value),required:!0})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Listen Port"}),(0,s.jsx)(y,{value:n.listen_port,onChange:e=>r("listen_port",e.target.value),required:!0})]})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Poll interval (ms)"}),(0,s.jsx)(y,{value:null!==(t=n.poll_interval_ms)&&void 0!==t?t:"",onChange:e=>r("poll_interval_ms",e.target.value),inputMode:"numeric",pattern:"[0-9]*"})]})]}),(0,s.jsxs)("section",{className:"space-y-4 rounded-lg border border-border bg-muted/10 p-4",children:[(0,s.jsxs)("header",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:"Telegram Bridge"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Configure optional Telegram notifications via bot API."})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:"Enabled"}),(0,s.jsx)(S,{checked:p,onCheckedChange:e=>r("telegram_enabled",e?"true":"false"),"aria-label":"Toggle Telegram notifications"})]})]}),(0,s.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"API Base"}),(0,s.jsx)(y,{value:n.telegram_api_base,onChange:e=>r("telegram_api_base",e.target.value),disabled:!p,placeholder:"https://api.telegram.org"})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Bot Token"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(y,{type:m?"text":"password",value:n.telegram_bot_token,onChange:e=>r("telegram_bot_token",e.target.value),disabled:!p,placeholder:"123456:ABC-DEF...",className:"pr-10"}),(0,s.jsx)(v.z,{type:"button",variant:"ghost",size:"icon",onClick:()=>x(e=>!e),disabled:!p,className:"absolute right-1.5 top-1/2 -translate-y-1/2","aria-label":m?"Hide bot token":"Show bot token",children:m?(0,s.jsx)(H.Z,{className:"h-4 w-4"}):(0,s.jsx)(G.Z,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Default Chat ID"}),(0,s.jsx)(y,{value:n.telegram_chat_id,onChange:e=>r("telegram_chat_id",e.target.value),disabled:!p,placeholder:"123456789"})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2 text-muted-foreground",children:[(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide",children:"Parse Mode"}),(0,s.jsxs)("select",{value:n.telegram_parse_mode,onChange:e=>r("telegram_parse_mode",e.target.value),disabled:!p,className:"h-10 w-full rounded-md border border-input bg-background px-3 text-sm text-foreground shadow-sm transition focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",children:[(0,s.jsx)("option",{value:"",children:"None"}),(0,s.jsx)("option",{value:"Markdown",children:"Markdown"}),(0,s.jsx)("option",{value:"MarkdownV2",children:"MarkdownV2"}),(0,s.jsx)("option",{value:"HTML",children:"HTML"})]})]})]})]})]}),(0,s.jsxs)(ea,{className:"gap-2",children:[(0,s.jsx)(v.z,{type:"button",variant:"outline",disabled:d,onClick:l,children:"Cancel"}),(0,s.jsx)(v.z,{type:"submit",disabled:d,children:d?"Saving…":"Save changes"})]})]})]})})}function ed(e){var t,a,l,n,r,i,d,o,c,u,m,x,p,g,f,b,j,y,N,w,S,C;let{open:_,onClose:k,preloginStatus:D,wanStatus:M}=e;if(!_)return null;let B=null!==(u=null==D?void 0:null===(l=D.wan_conns)||void 0===l?void 0:null===(a=l[0])||void 0===a?void 0:null===(t=a.ipConns)||void 0===t?void 0:t[0])&&void 0!==u?u:{},T=null!==(m=null==D?void 0:null===(n=D.root_info)||void 0===n?void 0:n[0])&&void 0!==m?m:{},I=null!==(x=null==M?void 0:null===(d=M.wan_conns)||void 0===d?void 0:null===(i=d[0])||void 0===i?void 0:null===(r=i.ipConns)||void 0===r?void 0:r[0])&&void 0!==x?x:{},E=null!==(g=null!==(p=I.DefaultGateway)&&void 0!==p?p:B.DefaultGateway)&&void 0!==g?g:"—",R=null!==(f=(0,h.SR)(D))&&void 0!==f?f:"—",U=null!==(j=null!==(b=I.X_CT_COM_IPv6IPAddress)&&void 0!==b?b:B.X_CT_COM_IPv6IPAddress)&&void 0!==j?j:"—",A=(B.DNSServers||"").split(/[ ,\n]+/).map(e=>e.trim()).filter(Boolean),z=A.length>0?A.join(", "):"Not provided",P=null!==(y=null==T?void 0:T.RootMacAddress)&&void 0!==y?y:"—",L=null!==(N=null==D?void 0:null===(c=D.device_cfg)||void 0===c?void 0:null===(o=c[0])||void 0===o?void 0:o.X_ALU_COM_LastActiveTime)&&void 0!==N?N:null,O=(0,h._o)(L),F="string"==typeof L&&""!==L.trim()&&"—"!==O&&O!==L?"".concat(O," • ").concat(L):O,V=[{label:"Connection",value:null!==(w=B.Name)&&void 0!==w?w:"—"},{label:"Status",value:null!==(C=null!==(S=I.ConnectionStatus)&&void 0!==S?S:B.ConnectionStatus)&&void 0!==C?C:"Unknown"},{label:"External IPv4",value:R},{label:"External IPv6",value:U},{label:"Gateway",value:null!=E?E:"—"},{label:"DNS Servers",value:z},{label:"MAC Address",value:P},{label:"Session Length",value:F}];return(0,s.jsx)(Y,{open:_,onOpenChange:e=>{e||k()},children:(0,s.jsxs)($,{children:[(0,s.jsxs)(J,{children:[(0,s.jsx)(K,{children:"WAN Connection Details"}),(0,s.jsx)(ee,{children:"Connection properties reported by the modem."})]}),(0,s.jsx)(et,{className:"max-h-[60vh] space-y-4 overflow-y-auto pr-1",children:(0,s.jsx)("div",{className:"grid gap-4 text-sm sm:grid-cols-2",children:V.map(e=>(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:e.label}),(0,s.jsx)("p",{className:"text-sm text-foreground",children:e.value})]},e.label))})}),(0,s.jsx)(ea,{children:(0,s.jsx)(v.z,{variant:"outline",onClick:k,children:"Close"})})]})})}en.displayName=el.gb.displayName;var eo=a(8004),ec=a(8595);let eu=null!==(l=a(357).env.NEXT_PUBLIC_API_BASE_URL)&&void 0!==l?l:"";async function em(e){let t=await fetch("".concat(eu).concat(e),{cache:"no-store"});if(!t.ok)throw Error("Request to ".concat(e," failed with ").concat(t.status));return await t.json()}function ex(){var e,t,a;let[l,u]=(0,o.useState)({}),[m,x]=(0,o.useState)(!0),[p,g]=(0,o.useState)(null),[b,j]=(0,o.useState)(1e3),[y,N]=(0,o.useState)(null),[w,S]=(0,o.useState)(!1),[C,_]=(0,o.useState)(0),[k,D]=(0,o.useState)(!1),[M,B]=(0,o.useState)(!1),[I,E]=(0,o.useState)(null),[R,U]=(0,o.useState)(!1),[A,z]=(0,o.useState)(null),[P,L]=(0,o.useState)(!1),[O,F]=(0,o.useState)(null),[V,W]=(0,o.useState)(!1),[Z,H]=(0,o.useState)(!1),[G,X]=(0,o.useState)(""),[Y,q]=(0,o.useState)(!1),[Q,$]=(0,o.useState)(!1),[J,K]=(0,o.useState)(!1),[ee,et]=(0,o.useState)(!0),ea=(0,o.useCallback)(e=>{var t;let a="success"===e.tone?c.Am.success:"error"===e.tone?c.Am.error:c.Am.info,l=null!==(t=e.title)&&void 0!==t?t:e.message,s=e.title?e.message:void 0;a(l,s?{description:s}:void 0)},[]);(0,o.useEffect)(()=>{let e=window.localStorage.getItem("pollingEnabled");null!==e&&et("true"===e)},[]);let el=(0,o.useCallback)(async e=>{if(!P){L(!0);try{let t=await fetch("".concat(eu,"/api/led_state"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enable:e})});if(!t.ok)throw Error("LED update failed (".concat(t.status,")"));z(e),u(t=>({...t,ledState:e})),ea({tone:"success",message:e?"Device LEDs enabled.":"Device LEDs disabled."})}catch(e){ea({tone:"error",message:e.message||"Unable to change LED state."})}finally{L(!1)}}},[P,ea]),es=(0,o.useCallback)(async()=>{if(!Y){q(!0),ea({tone:"info",message:"Renewing WAN IP…"});try{let e=(0,h.SR)(l.preloginStatus);await ep("/api/set_apn?apn=internet"),await eg(1e3),await ep("/api/set_apn?apn=xlunlimited"),await eg(1e3);let t=null,a=l.preloginStatus;for(let l=0;l<30&&(a=await em("/api/prelogin_status"),!(t=(0,h.SR)(a))||t===e);l+=1)await eg(1e3);t&&t!==e?(ea({tone:"success",message:"New WAN IP acquired: ".concat(t)}),u(e=>({...e,preloginStatus:a}))):ea({tone:"error",message:"Unable to obtain a new WAN IP. Please try again later."})}catch(e){ea({tone:"error",message:e.message||"WAN IP renewal failed."})}finally{q(!1),_(Date.now())}}},[l.preloginStatus,Y,ea]),en=(0,o.useCallback)(async()=>{if(!Q){$(!0),ea({tone:"info",message:"Sending reboot command…"});try{await em("/api/do_reboot"),ea({tone:"success",message:"Reboot command sent. Modem is restarting."})}catch(e){ea({tone:"error",message:e.message||"Unable to reboot the device."})}finally{$(!1)}}},[Q,ea]),ex=(0,o.useCallback)(async e=>{if(!J){K(!0);try{var t;let a=Math.max(Date.now(),(null!==(t=l.dataExpired)&&void 0!==t?t:0)*1e3),s=Math.floor((a+1e3*e)/1e3);await ep("/api/set_data_expired?data_expired=".concat(s)),u(e=>({...e,dataExpired:s})),ea({tone:"success",message:"Data expiration updated."})}catch(e){ea({tone:"error",message:e.message||"Failed to update data expiration."})}finally{K(!1)}}},[l.dataExpired,J,ea]),eh=(0,o.useCallback)(async e=>{if(e.preventDefault(),J)return;if(!G){ea({tone:"error",message:"Please pick a date first."});return}let t=new Date("".concat(G,"T00:00:00"));if(Number.isNaN(t.getTime())){ea({tone:"error",message:"Invalid date format."});return}K(!0);try{let e=Math.floor(t.getTime()/1e3);await ep("/api/set_data_expired?data_expired=".concat(e)),u(t=>({...t,dataExpired:e})),X(""),ea({tone:"success",message:"Expiration date saved."})}catch(e){ea({tone:"error",message:e.message||"Failed to save expiration date."})}finally{K(!1)}},[G,J,ea]),ef=(0,o.useCallback)(async()=>{if(!V){W(!0);try{let e=await em("/api/sms");u(t=>({...t,sms:(0,h.EE)(e)}))}catch(e){ea({tone:"error",message:e.message||"Unable to refresh SMS inbox."})}finally{W(!1)}}},[V,ea]),ev=(0,o.useCallback)(async(e,t)=>{if(!V){W(!0);try{let a="/api/set_sms_state?smsid=".concat(encodeURIComponent(e.SMSID),"&smsunread=").concat(t?1:0);await em(a),u(a=>{var l;return{...a,sms:null===(l=a.sms)||void 0===l?void 0:l.map(a=>a.SMSID===e.SMSID?{...a,SMSUnread:t}:a)}})}catch(e){ea({tone:"error",message:e.message||"Unable to update SMS state."})}finally{W(!1)}}},[V,ea]),eb=(0,o.useCallback)(async e=>{if(!V){W(!0);try{let t=await fetch("".concat(eu,"/api/delete_sms"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sms_ids:[e]})});if(!t.ok)throw Error("Failed to delete SMS (".concat(t.status,")"));u(t=>{var a;return{...t,sms:null===(a=t.sms)||void 0===a?void 0:a.filter(t=>t.SMSID!==e)}}),F(t=>t===e?null:t),ea({tone:"success",message:"SMS deleted."})}catch(e){ea({tone:"error",message:e.message||"Unable to delete SMS."})}finally{W(!1)}}},[V,ea]),ej=(0,o.useCallback)(()=>{l.config&&E((0,h.SD)(l.config,1e3)),D(!0)},[l.config]),ey=(0,o.useCallback)((e,t)=>{E(a=>a?{...a,[e]:t}:a)},[]),eN=(0,o.useCallback)(async e=>{if(e.preventDefault(),I&&!R){U(!0);try{await em("/api/config/listener_available?host=".concat(encodeURIComponent(I.listen_host),"&port=").concat(encodeURIComponent(I.listen_port)));let e={router_host:I.router_host,router_user:I.router_user,router_password:I.router_password,listen_host:I.listen_host,listen_port:I.listen_port,poll_interval_ms:(()=>{let e=Number(I.poll_interval_ms);return Number.isFinite(e)&&e>0?Math.max(500,e):1e3})(),telegram:{enabled:"true"===I.telegram_enabled,api_base:I.telegram_api_base.trim(),bot_token:I.telegram_bot_token.trim(),chat_id:I.telegram_chat_id.trim(),parse_mode:I.telegram_parse_mode.trim()}},t=await fetch("".concat(eu,"/api/config"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error((null==e?void 0:e.error)||"Config save failed (".concat(t.status,")"))}ea({tone:"success",message:"Configuration saved."}),D(!1),_(Date.now())}catch(e){ea({tone:"error",message:e.message||"Unable to save configuration."})}finally{U(!1)}}},[I,R,ea]);(0,o.useEffect)(()=>{let e=!0,t=null,a=async()=>{try{S(!0);let[t,a,l,s,n,r,i,d,o,c,m,x,p]=await Promise.all([em("/api/config"),em("/api/prelogin_status"),em("/api/status_web"),em("/api/service_data"),em("/api/cell_identification").catch(()=>null),em("/api/device_status"),em("/api/daily_usage"),em("/api/get_data_expired").catch(()=>null),em("/api/sms").catch(()=>null),em("/api/wlan_configs_24g").catch(()=>null),em("/api/wlan_configs_5g").catch(()=>null),em("/api/wan_status").catch(()=>null),em("/api/led_state").catch(()=>null)]);if(!e)return;let f=null!=t?t:{};u({config:f,preloginStatus:a,statusWeb:l,serviceData:s,cellIdentification:n,deviceStatus:r,dailyUsage:i,dataExpired:(0,h.GQ)(d),sms:(0,h.EE)(o),wlan24:c,wlan5:m,wanStatus:x,ledState:(0,h.Av)(p)}),z((0,h.Av)(p)),N(Date.now()),g(null);let v=Math.max(500,(0,h.Rg)(f,1e3));j(e=>e===v?e:v)}catch(t){var l;if(!e)return;g(null!==(l=t.message)&&void 0!==l?l:"Unable to load dashboard data.")}finally{if(!e)return;x(!1),S(!1),ee&&(t=setTimeout(a,b))}};return a(),()=>{e=!1,t&&clearTimeout(t)}},[b,C,ee]),(0,o.useEffect)(()=>{var e;if(!M)return;let t=null!==(e=l.sms)&&void 0!==e?e:[];if(0===t.length){F(null);return}F(e=>e&&t.some(t=>t.SMSID===e)?e:t[0].SMSID)},[l.sms,M]);let ew=(0,o.useMemo)(()=>Math.round(b/1e3),[b]),eS=null!==(t=null===(e=l.sms)||void 0===e?void 0:e.filter(e=>e.SMSUnread).length)&&void 0!==t?t:0,eC=(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(v.z,{type:"button",variant:ee?"secondary":"outline",size:"sm",onClick:()=>et(e=>{let t=!e;return window.localStorage.setItem("pollingEnabled",String(t)),t}),className:"h-9 gap-2 px-3",children:[(0,s.jsx)("span",{className:"h-2 w-2 rounded-full ".concat(ee?"bg-emerald-400 animate-pulse":"bg-muted-foreground")}),"Polling ",ee?"On":"Off"]}),(0,s.jsx)(v.z,{type:"button",variant:"outline",size:"icon",onClick:()=>{_(Date.now())},disabled:w,"aria-label":w?"Refreshing":"Refresh",children:w?(0,s.jsx)(n.Z,{className:"h-4 w-4 animate-spin"}):(0,s.jsx)(r.Z,{className:"h-4 w-4"})}),(0,s.jsxs)(v.z,{type:"button",variant:"outline",size:"icon",onClick:()=>B(!0),className:"relative","aria-label":"SMS Inbox",children:[(0,s.jsx)(i.Z,{className:"h-4 w-4"}),eS>0?(0,s.jsx)(f.C,{variant:"destructive",className:"absolute -right-1 -top-1 h-5 min-w-[1.25rem] rounded-full px-1 py-0 text-[10px]",children:eS}):null]}),(0,s.jsx)(v.z,{type:"button",variant:"outline",size:"icon",onClick:ej,"aria-label":"Configuration",children:(0,s.jsx)(d.Z,{className:"h-4 w-4"})})]});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(eo.V,{toolbar:eC,children:[(0,s.jsx)("section",{className:"space-y-4",children:(0,s.jsx)(ec.m,{eyebrow:"Nokia FastMile 5G Gateway 2",title:"Modem Dashboard",description:(0,s.jsxs)(s.Fragment,{children:["Live signal metrics, traffic usage, device health, and connected clients. Data refreshes automatically every ",ew," second",1===ew?"":"s","."]})})}),p&&(0,s.jsx)("div",{className:"rounded-lg border border-red-500/60 bg-red-500/10 px-4 py-3 text-sm text-red-200",children:p}),m?(0,s.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((e,t)=>(0,s.jsx)("div",{className:"h-48 animate-pulse rounded-xl border border-neutral-800 bg-neutral-900/60"},t))}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(T,{data:l,ledEnabled:A,ledBusy:P,onToggleLed:el,onRenewIp:es,renewing:Y,onReboot:en,rebooting:Q,onOpenWanDetails:()=>H(!0),onExtendData:ex,onCustomExpirySubmit:eh,onCustomExpiryChange:e=>X(e),customExpiry:G,expiryBusy:J}),(0,s.jsxs)("footer",{className:"flex flex-col gap-1 text-xs text-neutral-500 md:flex-row md:items-center md:justify-between",children:[(0,s.jsxs)("span",{children:["Last updated:"," ",y?new Date(y).toLocaleString():"—"]}),(0,s.jsxs)("span",{children:["Poll interval: ",ew," second",1===ew?"":"s"]})]})]})]}),(0,s.jsx)(er,{open:M,onClose:()=>B(!1),messages:null!==(a=l.sms)&&void 0!==a?a:[],busy:V,onRefresh:ef,onMarkRead:ev,onDelete:eb,selectedSmsId:O,onSelect:F}),(0,s.jsx)(ei,{open:k,onClose:()=>D(!1),draft:I,onChange:ey,onSubmit:eN,saving:R}),(0,s.jsx)(ed,{open:Z,onClose:()=>H(!1),preloginStatus:l.preloginStatus,wanStatus:l.wanStatus})]})}async function ep(e){let t=await fetch("".concat(eu).concat(e));if(!t.ok)throw Error("Request to ".concat(e," failed with ").concat(t.status));await t.json().catch(()=>null)}async function eg(e){return new Promise(t=>setTimeout(t,e))}}},function(e){e.O(0,[974,776,436,38,971,23,744],function(){return e(e.s=7162)}),_N_E=e.O()}]);