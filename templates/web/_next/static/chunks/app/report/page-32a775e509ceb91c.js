(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[420],{8907:function(e,l,t){Promise.resolve().then(t.bind(t,1397))},1397:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return p}});var d,a=t(7437),n=t(7138),o=t(2265),s=t(8004),r=t(8595),i=t(495),c=t(6013),u=t(571),x=t(7440),m=t(7104);let v=null!==(d=t(357).env.NEXT_PUBLIC_API_BASE_URL)&&void 0!==d?d:"";async function h(){let e=await fetch("".concat(v,"/api/daily_usage"),{cache:"no-store"});if(!e.ok)throw Error("Request failed with status ".concat(e.status));return e.json()}function p(){var e,l,t,d,v,p,f,j,N;let[y,w]=(0,o.useState)(null),[_,k]=(0,o.useState)(!0),[B,S]=(0,o.useState)(null);(0,o.useEffect)(()=>{let e=!0;return(async()=>{try{k(!0);let l=await h();if(!e)return;w(l),S(null)}catch(t){var l;if(!e)return;S(null!==(l=t.message)&&void 0!==l?l:"Unable to load usage report.")}finally{if(!e)return;k(!1)}})(),()=>{e=!1}},[]);let E=(0,o.useMemo)(()=>(null==y?void 0:y.daily_data)?y.daily_data:[],[y]),T=(0,o.useMemo)(()=>{if(0===E.length)return null;let e=E.reduce((e,l)=>{var t,d,a,n,o,s;return{download:e.download+(null!==(n=null===(t=l.download)||void 0===t?void 0:t.raw_bytes)&&void 0!==n?n:0),upload:e.upload+(null!==(o=null===(d=l.upload)||void 0===d?void 0:d.raw_bytes)&&void 0!==o?o:0),combined:e.combined+(null!==(s=null===(a=l.combined)||void 0===a?void 0:a.raw_bytes)&&void 0!==s?s:0)}},{download:0,upload:0,combined:0}),l=E.length;return{...e,days:l,average:l>0?e.combined/l:0}},[E]),D=null!==(v=null===(e=E[0])||void 0===e?void 0:e.date)&&void 0!==v?v:null,M=E.length>0?E[E.length-1].date:null,U=D&&M&&M!==D?"".concat(g(M)," – ").concat(g(D)):D?g(D):"—",Z=null!==(p=null==y?void 0:null===(l=y.total_usage)||void 0===l?void 0:l.combined)&&void 0!==p?p:T?(0,m.td)(T.combined):"0 B",L=null!==(f=null==y?void 0:null===(t=y.total_usage)||void 0===t?void 0:t.download)&&void 0!==f?f:T?(0,m.td)(T.download):"0 B",C=null!==(j=null==y?void 0:null===(d=y.total_usage)||void 0===d?void 0:d.upload)&&void 0!==j?j:T?(0,m.td)(T.upload):"0 B",O=T&&T.average>0?"".concat((0,m.td)(T.average)," / hari"):null,R=null!==(N=null==T?void 0:T.days)&&void 0!==N?N:E.length,I=(0,o.useMemo)(()=>{var e;return null!==(e=null==y?void 0:y.last_7_days)&&void 0!==e?e:[]},[y]),P=(0,o.useMemo)(()=>0===I.length?0:I.reduce((e,l)=>{var t,d;return Math.max(e,null!==(d=null===(t=l.combined)||void 0===t?void 0:t.raw_bytes)&&void 0!==d?d:0)},0),[I]),z=I.length>0,A=(0,a.jsx)(i.z,{asChild:!0,variant:"outline",size:"sm",className:"h-9 gap-2 px-4",children:(0,a.jsx)(n.default,{href:"/",children:"Back to dashboard"})});return(0,a.jsxs)(s.V,{toolbar:A,children:[(0,a.jsx)(r.m,{eyebrow:"Nokia FastMile 5G Gateway 2",title:"Data Usage Report",description:"Historical upload, download, and combined usage aggregated from modem telemetry."}),B&&(0,a.jsx)("div",{className:"rounded-lg border border-red-500/60 bg-red-500/10 px-4 py-3 text-sm text-red-200",children:B}),(0,a.jsxs)("section",{className:"grid gap-4 text-sm text-muted-foreground md:grid-cols-2 xl:grid-cols-4",children:[(0,a.jsx)(b,{label:"Reporting window",value:U,hint:R>0?"".concat(R," day").concat(1===R?"":"s"," tracked"):void 0}),(0,a.jsx)(b,{label:"Total combined",value:Z,hint:null!=O?O:void 0,tone:"purple"}),(0,a.jsx)(b,{label:"Total download",value:L,tone:"blue"}),(0,a.jsx)(b,{label:"Total upload",value:C,tone:"green"})]}),(0,a.jsxs)("section",{className:(0,x.cn)("grid gap-6",z?"lg:grid-cols-[minmax(260px,320px),1fr]":""),children:[z?(0,a.jsxs)(c.Zb,{className:"bg-card/80",children:[(0,a.jsxs)(c.Ol,{className:"pb-2",children:[(0,a.jsx)(c.ll,{className:"text-base font-semibold text-foreground",children:"Last 7 days"}),(0,a.jsx)(c.SZ,{className:"text-xs",children:"Top-level view of recent usage spikes."})]}),(0,a.jsx)(c.aY,{className:"space-y-4 text-xs",children:I.map(e=>{var l,t,d,n,o,s,r,i;let c=null!==(o=null===(l=e.combined)||void 0===l?void 0:l.formatted)&&void 0!==o?o:"0 B",x=null!==(s=null===(t=e.download)||void 0===t?void 0:t.formatted)&&void 0!==s?s:"0 B",m=null!==(r=null===(d=e.upload)||void 0===d?void 0:d.formatted)&&void 0!==r?r:"0 B",v=P>0?Math.min(100,(null!==(i=null===(n=e.combined)||void 0===n?void 0:n.raw_bytes)&&void 0!==i?i:0)/P*100):0;return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-[11px] uppercase tracking-wide text-muted-foreground",children:[(0,a.jsx)("span",{children:g(e.date)}),(0,a.jsx)("span",{className:"text-foreground",children:c})]}),(0,a.jsx)(u.E,{value:v}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-[11px] text-muted-foreground",children:[(0,a.jsxs)("span",{children:["Down: ",x]}),(0,a.jsxs)("span",{children:["Up: ",m]})]})]},e.date)})})]}):null,(0,a.jsx)(c.Zb,{className:"overflow-hidden bg-card/80",children:(0,a.jsx)(c.aY,{className:"p-0",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-border text-sm text-foreground",children:[(0,a.jsx)("thead",{className:"bg-muted/40 text-xs uppercase tracking-wider text-muted-foreground",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{scope:"col",className:"px-4 py-3 text-left",children:"Date"}),(0,a.jsx)("th",{scope:"col",className:"px-4 py-3 text-right",children:"Download"}),(0,a.jsx)("th",{scope:"col",className:"px-4 py-3 text-right",children:"Upload"}),(0,a.jsx)("th",{scope:"col",className:"px-4 py-3 text-right",children:"Total"}),(0,a.jsx)("th",{scope:"col",className:"px-4 py-3 text-right",children:"Share"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-border/70",children:_?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:5,className:"px-4 py-6 text-center text-xs text-muted-foreground",children:"Loading usage history…"})}):0===E.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:5,className:"px-4 py-6 text-center text-xs text-muted-foreground",children:"Usage history is not available yet."})}):E.map(e=>{var l,t,d,n,o,s,r,i;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-4 py-3 text-left",children:g(e.date)}),(0,a.jsx)("td",{className:"px-4 py-3 text-right text-blue-400",children:null!==(o=null===(l=e.download)||void 0===l?void 0:l.formatted)&&void 0!==o?o:"0 B"}),(0,a.jsx)("td",{className:"px-4 py-3 text-right text-emerald-400",children:null!==(s=null===(t=e.upload)||void 0===t?void 0:t.formatted)&&void 0!==s?s:"0 B"}),(0,a.jsx)("td",{className:"px-4 py-3 text-right font-semibold",children:null!==(r=null===(d=e.combined)||void 0===d?void 0:d.formatted)&&void 0!==r?r:"0 B"}),(0,a.jsx)("td",{className:"px-4 py-3 text-right text-muted-foreground",children:"number"!=typeof(i=null===(n=e.combined)||void 0===n?void 0:n.percentage)||Number.isNaN(i)?"0%":"".concat(i.toFixed(1),"%")})]},e.date)})})]})})})})]})]})}function g(e){if(!e)return"—";let l=new Date("".concat(e,"T00:00:00Z"));return Number.isNaN(l.getTime())?e:l.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})}function b(e){let{label:l,value:t,hint:d,tone:n="neutral"}=e;return(0,a.jsx)(c.Zb,{className:"bg-card/80",children:(0,a.jsxs)(c.Ol,{className:"space-y-2",children:[(0,a.jsx)(c.SZ,{className:"text-xs uppercase tracking-wide",children:l}),(0,a.jsx)(c.ll,{className:(0,x.cn)("text-lg font-semibold","blue"===n?"text-blue-400":"green"===n?"text-emerald-400":"purple"===n?"text-purple-400":"text-foreground"),children:t}),d?(0,a.jsx)(c.SZ,{className:"text-xs text-muted-foreground",children:d}):null]})})}}},function(e){e.O(0,[974,38,971,23,744],function(){return e(e.s=8907)}),_N_E=e.O()}]);